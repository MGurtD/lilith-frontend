import{d as V,k as R,H as x,o as h,r as C,h as c,a as I,c as k,e as a,i,l as w,G as g}from"./index-f6af8c81.js";import{_ as E}from"./DropdownCustomers.vue_vue_type_script_setup_true_lang-0951f83c.js";import{c as B,a as d,e as D,F}from"./form-validator-ec7c2535.js";const S={class:"mt-2"},$=a("label",{class:"block text-900 mb-2"},"Client",-1),y={class:"mt-2"},O=a("label",{class:"block text-900 mb-2"},"Exercici",-1),L={class:"mt-2"},N=a("label",{class:"block text-900 mb-2"},"Data",-1),T={class:"mt-2"},G=V({__name:"FormCreateOrderOrInvoice",props:{createRequest:{}},emits:["submit"],setup(u,{emit:m}){const s=u,p=R(),l=x();h(async()=>{var t;l.exercises||await l.fetchActive();var e=(t=l.exercises)==null?void 0:t.find(o=>o.name===new Date().getFullYear().toString());e&&(s.createRequest.exerciseId=e.id)});const f=B().shape({exerciseId:d().required("L'exercici és obligatori"),customerId:d().required("El client és obligatori"),date:D().required("La data és obligatòria")}),n=C({result:!1,errors:{}}),b=()=>{const e=new F(f);n.value=e.validate(s.createRequest)},_=()=>{if(b(),n.value.result)s.createRequest.date=g(s.createRequest.date),m("submit",s.createRequest);else{let e="";Object.entries(n.value.errors).forEach(t=>{e+=`${t[1].map(o=>o)}.   `}),p.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,t)=>{const o=c("Dropdown"),v=c("Calendar"),q=c("Button");return I(),k("form",null,[a("div",S,[$,i(E,{label:"",placeholder:"",modelValue:e.createRequest.customerId,"onUpdate:modelValue":t[0]||(t[0]=r=>e.createRequest.customerId=r)},null,8,["modelValue"])]),a("div",y,[O,i(o,{class:"w-full",modelValue:e.createRequest.exerciseId,"onUpdate:modelValue":t[1]||(t[1]=r=>e.createRequest.exerciseId=r),editable:"",options:w(l).exercises,optionValue:"id",optionLabel:"name"},null,8,["modelValue","options"])]),a("div",L,[N,i(v,{modelValue:e.createRequest.date,"onUpdate:modelValue":t[2]||(t[2]=r=>e.createRequest.date=r)},null,8,["modelValue"])]),a("footer",T,[i(q,{label:"Crear",onClick:_,style:{float:"right"}})])])}}});export{G as _};
