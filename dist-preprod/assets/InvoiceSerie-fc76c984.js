import{d as x,k as E,r as y,h as V,c as C,e as m,i as o,n as t,D as u,l as S,m as N,a as k,v as w,F as v,g as B,x as P,u as U,E as F,o as L,q as T,P as M}from"./index-f6af8c81.js";import{u as D}from"./purchaseInvoiceSeries-f419a402.js";import{c as R,a as f,d as g,F as $}from"./form-validator-ec7c2535.js";import"./index-d3847f4f.js";import"./suppliers.service-f3c59018.js";const q={key:0},A={class:"three-columns"},z=m("label",{class:"block text-900 mb-2"},"Desactivada",-1),O={class:"four-columns"},j={class:"mt-2"},G=x({__name:"FormInvoiceSerie",props:{purchaseInvoiceSerie:{}},emits:["submit","cancel"],setup(I,{emit:c}){const d=I,p=E(),b=R().shape({name:f().required("El nom de la sèrie és obligatori").max(50,"El nom de la sèrie no pot superar els 50 caràcters"),description:f().required("La descripció de la sèrie és obligatòria").max(250,"La descripció de la sèrie no pot superar els 50 caràcters"),prefix:f().max(10,"El prefix no pot superar els 10 caràcters"),suffix:f().max(10,"El sufix no pot superar els 10 caràcters"),nextNumber:g().positive("El següent número ha de ser positiu").integer("El següent número ha de ser un número enter").required("El següent número és obligatori"),length:g().positive("La longitud ha de ser positiva").integer("La longitud ha de ser un número enter").min(1,"La longitud ha de ser almenys 1").max(20,"La longitud no pot superar els 20 caràcters").required("La longitud és obligatòria")}),r=y({result:!1,errors:{}}),l=()=>{const e=new $(b);r.value=e.validate(d.purchaseInvoiceSerie)},h=async()=>{if(l(),r.value.result)c("submit",d.purchaseInvoiceSerie);else{let e="";Object.entries(r.value.errors).forEach(a=>{e+=`${a[1].map(i=>i)}.   `}),p.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,a)=>{const i=V("Checkbox"),n=V("Button");return e.purchaseInvoiceSerie?(k(),C("form",q,[m("section",A,[o(u,{name:"name",class:t(["mb-2",{"p-invalid":r.value.errors.name}]),label:"Nom de la sèrie",id:"name",modelValue:e.purchaseInvoiceSerie.name,"onUpdate:modelValue":a[0]||(a[0]=s=>e.purchaseInvoiceSerie.name=s)},null,8,["modelValue","class"]),o(u,{name:"description",class:t(["mb-2",{"p-invalid":r.value.errors.description}]),label:"Descripció",id:"description",modelValue:e.purchaseInvoiceSerie.description,"onUpdate:modelValue":a[1]||(a[1]=s=>e.purchaseInvoiceSerie.description=s)},null,8,["modelValue","class"]),m("div",null,[z,o(i,{modelValue:e.purchaseInvoiceSerie.disabled,"onUpdate:modelValue":a[2]||(a[2]=s=>e.purchaseInvoiceSerie.disabled=s),class:"w-full",binary:!0},null,8,["modelValue"])])]),m("section",O,[o(u,{name:"prefix",class:t(["mb-2",{"p-invalid":r.value.errors.prefix}]),label:"Prefix",id:"prefix",modelValue:e.purchaseInvoiceSerie.prefix,"onUpdate:modelValue":a[3]||(a[3]=s=>e.purchaseInvoiceSerie.prefix=s)},null,8,["modelValue","class"]),o(u,{name:"suffix",class:t(["mb-2",{"p-invalid":r.value.errors.suffix}]),label:"Sufix",id:"suffix",modelValue:e.purchaseInvoiceSerie.suffix,"onUpdate:modelValue":a[4]||(a[4]=s=>e.purchaseInvoiceSerie.suffix=s)},null,8,["modelValue","class"]),o(u,{name:"nextNumber",class:t(["mb-2",{"p-invalid":r.value.errors.nextNumber}]),label:"Següent número",id:"nextNumber",type:S(w).NUMERIC,modelValue:e.purchaseInvoiceSerie.nextNumber,"onUpdate:modelValue":a[5]||(a[5]=s=>e.purchaseInvoiceSerie.nextNumber=s),modelModifiers:{number:!0}},null,8,["type","modelValue","class"]),o(u,{name:"length",class:t(["mb-2",{"p-invalid":r.value.errors.length}]),label:"Longitud",id:"length",modelValue:e.purchaseInvoiceSerie.length,"onUpdate:modelValue":a[6]||(a[6]=s=>e.purchaseInvoiceSerie.length=s),modelModifiers:{number:!0}},null,8,["modelValue","class"])]),m("div",j,[o(n,{label:"Guardar",class:"mr-2",onClick:h})])])):N("",!0)}}}),X=x({__name:"InvoiceSerie",setup(I){const c=y(v.EDIT),d=B(),p=P(),b=U(),r=D(),{purchaseInvoiceSerie:l}=F(r),h=async()=>{await r.fetchPurchaseInvoiceSerie(p.params.id);let i="";l.value?(c.value=v.EDIT,i=`Sèrie de facturació: ${l.value.name}`):(c.value=v.CREATE,r.setNewPurchaseInvoiceSerie(p.params.id),i="Alta de sèrie de facturació"),b.setMenuItem({icon:M.POUND,backButtonVisible:!0,title:i})};L(async()=>{await h()});const e=E(),a=async()=>{const i=l.value;let n=!1,s="";c.value===v.CREATE?(n=await r.createPurchaseInvoiceSerie(i),s="Sèrie de facturació creada correctament"):(n=await r.updatePurchaseInvoiceSerie(i.id,i),s="Sèrie de facturació actualizada correctament"),n&&(e.add({severity:"success",summary:s,life:5e3}),d.back())};return(i,n)=>S(l)?(k(),T(G,{key:0,purchaseInvoiceSerie:S(l),onSubmit:a},null,8,["purchaseInvoiceSerie"])):N("",!0)}});export{X as default};
