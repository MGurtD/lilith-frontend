import{d as P,r as N,k as A,z as L,g as M,u as F,Y as R,o as U,P as d,h as i,c as j,i as e,l as u,w as a,N as z,C as S,a as G,e as c,n as h,t as K,p as Y,b as J,f as O}from"./index-f6af8c81.js";import{u as Q}from"./customers-bf96fe43.js";const y=m=>(Y("data-v-493f5c83"),m=m(),J(),m),W=y(()=>c("span",null,"Clients",-1)),X={class:"references-header"},Z={class:"references-filter"},ee=y(()=>c("label",null,"Nom comercial",-1)),te=["onClick"],se=y(()=>c("span",null,"Tipus de client",-1)),oe=["onClick"],ae=P({__name:"Customers",setup(m){const f=N(0),b=A(),g=L(),p=M(),k=F(),l=Q(),_=N({code:""}),x=R(()=>l.customers?_.value.code.length>0?l.customers.filter(t=>t.comercialName.toLowerCase().includes(_.value.code.toLowerCase())):l.customers:[]);U(async()=>{await l.fetchCustomers(),await l.fetchCustomerTypes(),k.setMenuItem({title:"Clients",icon:d.HASHTAG})});const B=t=>{var r;const s=(r=l.customerTypes)==null?void 0:r.find(C=>C.id===t);if(s)return s.name},E=(t,s)=>{g.require({target:t.currentTarget,message:`Está segur que vol eliminar el client ${s.comercialName}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await l.deleteCustomer(s.id)&&(b.add({severity:"success",summary:"Eliminat",life:3e3}),await l.fetchCustomers())}})},D=(t,s)=>{g.require({target:t.currentTarget,message:`Está segur que vol eliminar el tipus de client ${s.name}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await l.deleteCustomerType(s.id)&&(b.add({severity:"success",summary:"Eliminat",life:3e3}),await l.fetchCustomerTypes())}})},V=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||p.push({path:`/customers/${t.data.id}`})},q=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||p.push({path:`/customer-types/${t.data.id}`})},H=()=>{f.value===0?p.push({path:`/customers/${S()}`}):p.push({path:`/customer-types/${S()}`})};return(t,s)=>{const r=i("Button"),C=i("BaseInput"),n=i("Column"),w=i("BooleanColumn"),T=i("DataTable"),I=i("TabPanel"),$=i("TabView");return G(),j(z,null,[e(r,{icon:u(d).PLUS,class:"grid_add_row_button",rounded:"",onClick:H},null,8,["icon"]),e($,{activeIndex:f.value,"onUpdate:activeIndex":s[1]||(s[1]=o=>f.value=o)},{default:a(()=>[e(I,null,{header:a(()=>[c("i",{class:h([u(d).LINK,"mr-2"])},null,2),W]),default:a(()=>[e(T,{value:x.value,tableStyle:"min-width: 100%","sort-field":"comercialName","sort-order":1,scrollable:"",scrollHeight:"80vh",paginator:"",rows:12,onRowClick:V},{header:a(()=>[c("div",X,[c("div",Z,[ee,e(C,{modelValue:_.value.code,"onUpdate:modelValue":s[0]||(s[0]=o=>_.value.code=o)},null,8,["modelValue"])])])]),default:a(()=>[e(n,{field:"comercialName",header:"Nom comercial",sortable:"",style:{width:"20%"}}),e(n,{field:"taxName",header:"Nom Fiscal",style:{width:"20%"}}),e(n,{field:"vatNumber",header:"CIF",style:{width:"20%"}}),e(n,{header:"Tipus",style:{width:"20%"}},{body:a(o=>[c("span",null,K(B(o.data.customerTypeId)),1)]),_:1}),e(n,{header:"Desactivat",sortable:"",style:{width:"20%"}},{body:a(o=>[e(w,{value:o.data.disabled,showColor:!1},null,8,["value"])]),_:1}),e(n,null,{body:a(o=>[c("i",{class:h([u(d).TIMES,"grid_delete_column_button"]),onClick:v=>E(v,o.data)},null,10,te)]),_:1})]),_:1},8,["value"])]),_:1}),e(I,null,{header:a(()=>[c("i",{class:h([u(d).HASHTAG,"mr-2"])},null,2),se]),default:a(()=>[e(T,{value:u(l).customerTypes,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",onRowClick:q},{default:a(()=>[e(n,{field:"name",header:"Nom",style:{width:"33%"}}),e(n,{field:"description",header:"Descripció",style:{width:"33%"}}),e(n,{header:"Desactivat",style:{width:"33%"}},{body:a(o=>[e(w,{value:o.data.disabled},null,8,["value"])]),_:1}),e(n,null,{body:a(o=>[c("i",{class:h([u(d).TIMES,"grid_delete_column_button"]),onClick:v=>D(v,o.data)},null,10,oe)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["activeIndex"])],64)}}});const ce=O(ae,[["__scopeId","data-v-493f5c83"]]);export{ce as default};
