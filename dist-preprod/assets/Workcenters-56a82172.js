import{d as N,g as A,u as W,k as q,z as E,o as L,P as m,r as M,Y as R,h as u,q as P,w as d,a as U,e as r,i as n,l as p,I as _,t as w,n as $,C as j}from"./index-f6af8c81.js";import{u as z}from"./plantmodel-2dcc063a.js";import{u as F}from"./shift-c7af583d.js";import"./index-5443ddc0.js";const H={class:"flex flex-wrap align-items-center justify-content-between gap-2"},G={class:"datatable-filter"},Y={class:"filter-field"},J=r("label",{class:"block text-900 mb-2"},"Tipus",-1),K={class:"filter-field"},O=r("label",{class:"block text-900 mb-2"},"Àrea",-1),Q={class:"datatable-buttons"},X=["onClick"],ne=N({__name:"Workcenters",setup(Z){const f=A(),h=W(),k=q(),v=E(),o=z(),y=F();L(async()=>{await o.fetchWorkcenters(),await o.fetchWorkcenterTypes(),await o.fetchAreas(),await y.fetchAllShifts(),h.setMenuItem({icon:m.CALENDAR,title:"Gestió de màquines"})});const s=M({areaId:void 0,workcenterTypeId:void 0}),b=R(()=>{if(!o.workcenters)return[];let t=o.workcenters;return s.value.areaId&&(t=t.filter(e=>e.areaId===s.value.areaId)),s.value.workcenterTypeId&&(t=t.filter(e=>e.workcenterTypeId===s.value.workcenterTypeId)),t}),I=()=>{s.value.areaId=void 0,s.value.workcenterTypeId=void 0},T=t=>{var l;const e=(l=o.areas)==null?void 0:l.find(i=>i.id===t);return e?e.name:""},C=t=>{var l;const e=(l=o.workcenterTypes)==null?void 0:l.find(i=>i.id===t);return e?e.name:""},g=()=>{f.push({path:`/workcenter/${j()}`})},S=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||f.push({path:`/workcenter/${t.data.id}`})},B=(t,e)=>{v.require({target:t.currentTarget,message:`Está segur que vol eliminar la màquina ${e.name}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await o.deleteWorkcenter(e.id)&&(k.add({severity:"success",summary:"Eliminat",life:3e3}),await o.fetchWorkcenters())}})};return(t,e)=>{const l=u("Dropdown"),i=u("Button"),c=u("Column"),V=u("BooleanColumn"),D=u("DataTable");return U(),P(D,{value:b.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",sortMode:"multiple",onRowClick:S},{header:d(()=>[r("div",H,[r("div",G,[r("div",Y,[J,n(l,{modelValue:s.value.workcenterTypeId,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.workcenterTypeId=a),editable:"",options:p(o).workcenterTypes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),r("div",K,[O,n(l,{modelValue:s.value.areaId,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.areaId=a),editable:"",options:p(o).areas,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("div",Q,[n(i,{class:"datatable-button mr-2",icon:p(m).FILTER_SLASH,rounded:"",raised:"",onClick:I},null,8,["icon"]),n(i,{icon:p(m).PLUS,rounded:"",raised:"",onClick:g},null,8,["icon"])])])]),default:d(()=>[n(c,{field:"name",header:"Nom",style:{width:"20%"}}),n(c,{field:"description",header:"Descripció",style:{width:"40%"}}),n(c,{header:"Tipus",style:{width:"15%"}},{body:d(a=>[_(w(C(a.data.workcenterTypeId)),1)]),_:1}),n(c,{header:"Area",style:{width:"15%"}},{body:d(a=>[_(w(T(a.data.areaId)),1)]),_:1}),n(c,{header:"Desactivat",style:{width:"10%"}},{body:d(a=>[n(V,{value:a.data.disabled},null,8,["value"])]),_:1}),n(c,null,{body:d(a=>[r("i",{class:$([p(m).TIMES,"grid_delete_column_button"]),onClick:x=>B(x,a.data)},null,10,X)]),_:1})]),_:1},8,["value"])}}});export{ne as default};
