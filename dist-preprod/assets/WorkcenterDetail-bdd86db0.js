import{d as x,x as R,ar as j,r as N,M as ee,o as L,h as B,a as f,c as b,i as s,w as d,l as r,as as g,I,t as _,J as te,e as a,n as D,P as h,at as G,m as k,N as oe,f as E,au as re,a9 as w,a8 as ae,av as ne,aw as se,ax as le,aa as ie,ay as U,V as W,az as C,q as $,aA as ce,aB as de,aC as ue,aD as pe,aE as fe,ae as _e,Y as he,an as q,p as M,b as F,aF as me,u as ve}from"./index-f6af8c81.js";import{u as Y}from"./plantmodel-2dcc063a.js";import{P as Q}from"./index-5443ddc0.js";import{u as K}from"./customers-bf96fe43.js";import{u as V}from"./reference-75fb097d.js";import{s as be}from"./progressbar.esm-3f2772cf.js";const ge={key:0,class:""},ye=x({__name:"WorkcenterDetailPlanning",setup(e){const t=R(),o=j(),n=V(),i=K(),l=N(void 0),p=ee({visible:!1,title:"Informació de la ordre de fabricació",closable:!0,position:"center",modal:!0});L(async()=>{const u=t.params.id;o.workcenter||o.fetchWorkcenter(u),l.value=await Q.PlanningService.GetByWorkcenterId(u)});const m=async u=>{p.visible=!0},O=async u=>{await o.openWorkOrderPhase(u.id)};return(u,v)=>{const y=B("Button"),S=B("Dialog");return f(),b(oe,null,[l.value?(f(),b("div",ge,[s(r(G),{value:l.value,class:"p-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"72vh"},{default:d(()=>[s(r(g),{field:"workOrder.code",header:"OF"}),s(r(g),{field:"code",header:"Fase"},{body:d(c=>[I(_(c.data.code+" - "+c.data.description),1)]),_:1}),s(r(g),{header:"Client"},{body:d(c=>[I(_(r(i).getCustomerNameById(c.data.workOrder.reference.customerId)),1)]),_:1}),s(r(g),{header:"Referència"},{body:d(c=>[I(_(r(n).getFullNameById(c.data.workOrder.referenceId)),1)]),_:1}),s(r(g),{field:"workOrder.plannedDate",header:"Data"},{body:d(c=>[I(_(r(te)(c.data.workOrder.plannedDate))+" ("+_(c.data.workOrder.order)+") ",1)]),_:1}),s(r(g),{field:"workOrder.order",header:"Preferida"},{body:d(c=>{var P;return[a("i",{class:D(c.data.preferredWorkcenterId===((P=r(o).workcenter)==null?void 0:P.workcenterId)?r(h).STAR_FILL:r(h).STAR)},null,2)]}),_:1}),s(r(g),{header:""},{body:d(c=>[s(y,{icon:r(h).SEARCH,severity:"info",size:"small",onClick:P=>m(c.data)},null,8,["icon","onClick"]),I("   "),s(y,{icon:r(h).PLAY,severity:"success",size:"small",onClick:P=>O(c.data)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["value"])])):k("",!0),s(S,{visible:p.visible,"onUpdate:visible":v[0]||(v[0]=c=>p.visible=c),header:p.title,closable:p.closable,modal:p.modal},null,8,["visible","header","closable","modal"])],64)}}});const we=E(ye,[["__scopeId","data-v-c88a34ad"]]);var J={name:"MinusIcon",extends:re},ke=a("path",{d:"M13.2222 7.77778H0.777778C0.571498 7.77778 0.373667 7.69584 0.227806 7.54998C0.0819442 7.40412 0 7.20629 0 7.00001C0 6.79373 0.0819442 6.5959 0.227806 6.45003C0.373667 6.30417 0.571498 6.22223 0.777778 6.22223H13.2222C13.4285 6.22223 13.6263 6.30417 13.7722 6.45003C13.9181 6.5959 14 6.79373 14 7.00001C14 7.20629 13.9181 7.40412 13.7722 7.54998C13.6263 7.69584 13.4285 7.77778 13.2222 7.77778Z",fill:"currentColor"},null,-1),Oe=[ke];function Ie(e,t,o,n,i,l){return f(),b("svg",w({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.pti()),Oe,16)}J.render=Ie;var Se={root:function(t){var o=t.props;return["p-panel p-component",{"p-panel-toggleable":o.toggleable}]},header:"p-panel-header",title:"p-panel-title",icons:"p-panel-icons",toggler:"p-panel-header-icon p-panel-toggler p-link",toggleablecontent:"p-toggleable-content",content:"p-panel-content",footer:"p-panel-footer"},Pe=ae.extend({name:"panel",classes:Se}),De={name:"BasePanel",extends:ie,props:{header:String,toggleable:Boolean,collapsed:Boolean,toggleButtonProps:{type:null,default:null}},style:Pe,provide:function(){return{$parentInstance:this}}},X={name:"Panel",extends:De,inheritAttrs:!1,emits:["update:collapsed","toggle"],data:function(){return{id:this.$attrs.id,d_collapsed:this.collapsed}},watch:{"$attrs.id":{immediate:!0,handler:function(t){this.id=t||ne()}},collapsed:function(t){this.d_collapsed=t}},methods:{toggle:function(t){this.d_collapsed=!this.d_collapsed,this.$emit("update:collapsed",this.d_collapsed),this.$emit("toggle",{originalEvent:t,value:this.d_collapsed})},onKeyDown:function(t){(t.code==="Enter"||t.code==="NumpadEnter"||t.code==="Space")&&(this.toggle(t),t.preventDefault())}},computed:{buttonAriaLabel:function(){return this.toggleButtonProps&&this.toggleButtonProps.ariaLabel?this.toggleButtonProps.ariaLabel:this.header}},components:{PlusIcon:se,MinusIcon:J},directives:{ripple:le}};function T(e){"@babel/helpers - typeof";return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(e)}function H(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),o.push.apply(o,n)}return o}function z(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?H(Object(o),!0).forEach(function(n){Ce(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):H(Object(o)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})}return e}function Ce(e,t,o){return t=Be(t),t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Be(e){var t=$e(e,"string");return T(t)=="symbol"?t:String(t)}function $e(e,t){if(T(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var n=o.call(e,t||"default");if(T(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var We=["id"],Te=["id","aria-label","aria-controls","aria-expanded"],Ne=["id","aria-labelledby"];function xe(e,t,o,n,i,l){var p=U("ripple");return f(),b("div",w({class:e.cx("root")},e.ptmi("root")),[a("div",w({class:e.cx("header")},e.ptm("header")),[W(e.$slots,"header",{id:i.id+"_header",class:D(e.cx("title"))},function(){return[e.header?(f(),b("span",w({key:0,id:i.id+"_header",class:e.cx("title")},e.ptm("title")),_(e.header),17,We)):k("",!0)]}),a("div",w({class:e.cx("icons")},e.ptm("icons")),[W(e.$slots,"icons"),e.toggleable?C((f(),b("button",w({key:0,id:i.id+"_header",type:"button",role:"button",class:e.cx("toggler"),"aria-label":l.buttonAriaLabel,"aria-controls":i.id+"_content","aria-expanded":!i.d_collapsed,onClick:t[0]||(t[0]=function(){return l.toggle&&l.toggle.apply(l,arguments)}),onKeydown:t[1]||(t[1]=function(){return l.onKeyDown&&l.onKeyDown.apply(l,arguments)})},z(z({},e.toggleButtonProps),e.ptm("toggler"))),[W(e.$slots,"togglericon",{collapsed:i.d_collapsed},function(){return[(f(),$(ue(i.d_collapsed?"PlusIcon":"MinusIcon"),ce(de(e.ptm("togglericon"))),null,16))]})],16,Te)),[[p]]):k("",!0)],16)],16),s(fe,w({name:"p-toggleable-content"},e.ptm("transition")),{default:d(function(){return[C(a("div",w({id:i.id+"_content",class:e.cx("toggleablecontent"),role:"region","aria-labelledby":i.id+"_header"},e.ptm("toggleablecontent")),[a("div",w({class:e.cx("content")},e.ptm("content")),[W(e.$slots,"default")],16),e.$slots.footer?(f(),b("div",w({key:0,class:e.cx("footer")},e.ptm("footer")),[W(e.$slots,"footer")],16)):k("",!0)],16,Ne),[[pe,!i.d_collapsed]])]}),_:3},16)],16)}X.render=xe;const Z=e=>(M("data-v-fc6f5f9f"),e=e(),F(),e),Re={key:0,class:"current-work-container"},je=Z(()=>a("div",{class:"workcenter-picture-container"},null,-1)),Le={key:0,class:"current-work-information"},Ee={class:"progress-bar"},Ae={key:1},Me=Z(()=>a("p",null,"No hi ha treball carregat al centre de treball",-1)),Fe=[Me],Ke=x({__name:"WorkcenterDetailCurrentWork",setup(e){const t=R(),o=j(),n=V(),i=K(),l=N(void 0);L(async()=>{var O;const m=t.params.id;if(await o.fetchWorkcenter(m,!0),o.workcenterImageBlob){const u=await _e(o.workcenterImageBlob);u.classList.add("workcenter-picture"),u.style.maxWidth="400px",u.style.maxHeight="400px",(O=document.querySelector(".workcenter-picture-container"))==null||O.appendChild(u)}p.value&&(l.value=await Q.PlanningService.GetWorkOrderPhaseById(p.value.phaseId))});const p=he(()=>{if(o.workcenter&&o.workcenter.workOrderPhases&&o.workcenter.workOrderPhases.length>0)return o.workcenter.workOrderPhases[0]});return(m,O)=>r(o).workcenter?(f(),b("main",Re,[je,s(r(X),{header:"Informació treball actual"},{default:d(()=>{var u,v,y,S;return[l.value?(f(),b("article",Le,[a("h4",null," Ordre: "+_((u=l.value.workOrderPhase.workOrder)==null?void 0:u.code)+" | Fase "+_(l.value.workOrderPhase.code)+" - "+_(l.value.workOrderPhase.description),1),a("h4",null," Referencia: "+_(r(n).getFullNameById(l.value.workOrderPhase.workOrder.referenceId)),1),a("h4",null," Client: "+_(r(i).getCustomerNameById(l.value.workOrderPhase.workOrder.reference.customerId)),1),a("h4",null," Hora inici: "+_(r(q)((v=p.value)==null?void 0:v.phaseStartTime)),1),a("h4",null,"Quantitat OK: "+_((y=p.value)==null?void 0:y.counterOk),1),a("h4",null,"Quantitat KO: "+_((S=p.value)==null?void 0:S.counterKo),1),a("div",Ee,[s(r(be),{value:75})])])):(f(),b("article",Ae,Fe))]}),_:1})])):k("",!0)}});const Ve=E(Ke,[["__scopeId","data-v-fc6f5f9f"]]),He=e=>(M("data-v-cf41d1fb"),e=e(),F(),e),ze={key:0,class:""},Ge={class:"flex flex-wrap align-items-center justify-content-between gap-2"},Ue=He(()=>a("span",{class:"text-xl text-900 font-bold"},"Operaris fitxats",-1)),qe=x({__name:"WorkcenterDetailOperators",setup(e){const t=R(),o=j(),n=Y();L(async()=>{const m=t.params.id;o.workcenter||o.fetchWorkcenter(m),n.operatorTypes||await n.fetchOperatorTypes()});const i=m=>!o.workcenter||!o.workcenter.operators?!1:!!o.workcenter.operators.find(O=>O.operatorId===m),l=async()=>{await o.clockInOperator(o.operator.id)},p=async()=>{await o.clockOutOperator(o.operator.id)};return(m,O)=>{const u=B("Button");return r(o).workcenter?(f(),b("div",ze,[s(r(G),{value:r(o).workcenter.operators,class:"p-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"72vh"},{header:d(()=>[a("div",Ge,[Ue,i(r(o).operator.id)?(f(),$(u,{key:1,severity:"danger",label:"Desfitxar",size:"small",icon:r(h).SIGN_IN,raised:"",onClick:p},null,8,["icon"])):(f(),$(u,{key:0,severity:"success",label:"Fitxar",size:"small",icon:r(h).SIGN_IN,raised:"",onClick:l},null,8,["icon"]))])]),default:d(()=>[s(r(g),{field:"operatorName",header:"Nom"}),s(r(g),{field:"operatorTypeDescription",header:"Tipus"}),s(r(g),{field:"startTime",header:"Hora d'inici"},{body:d(v=>[I(_(r(q)(v.data.startTime)),1)]),_:1}),s(r(g),{header:"Temps"},{body:d(v=>[I(_(r(me)(v.data.startTime)),1)]),_:1})]),_:1},8,["value"])])):k("",!0)}}});const Ye=E(qe,[["__scopeId","data-v-cf41d1fb"]]),A=e=>(M("data-v-57675b38"),e=e(),F(),e),Qe={class:"container"},Je={class:"header test"},Xe={key:0},Ze={class:"header-text"},et={class:"main test"},tt={class:"button-panel"},ot={class:"test"},rt={class:"flex align-items-center gap-2"},at=A(()=>a("span",{class:"font-bold white-space-nowrap"},"Treball actual",-1)),nt={class:"flex align-items-center gap-2"},st=A(()=>a("span",{class:"font-bold white-space-nowrap"},"Treballs disponibles",-1)),lt={class:"flex align-items-center gap-2"},it=A(()=>a("span",{class:"font-bold white-space-nowrap"},"Consum materials",-1)),ct={class:"flex align-items-center gap-2"},dt=A(()=>a("span",{class:"font-bold white-space-nowrap"},"Operaris",-1)),ut=x({__name:"WorkcenterDetail",setup(e){const t=ve(),o=R(),n=j();Y();const i=V(),l=K(),p=N(""),m=N(0);return L(async()=>{p.value=o.params.id,await n.fetchWorkcenter(p.value),n.workcenter?(t.setMenuItem({icon:h.BUILDING,title:"Detall de centre de treball",backButtonVisible:!0}),n.getOperator()):t.setMenuItem({icon:h.BUILDING,title:"No s'ha trobat el centre de treball",backButtonVisible:!0}),(!i.references||i.module!=="sales")&&await i.fetchReferencesByModule("sales"),l.customers||await l.fetchCustomers()}),(O,u)=>{const v=B("Button"),y=B("TabPanel"),S=B("TabView"),c=U("tooltip");return f(),b("div",Qe,[a("header",Je,[r(n).workcenter?(f(),b("div",Xe,[a("p",Ze,_(r(n).workcenter.workcenterName)+" - "+_(r(n).workcenter.workcenterDescription)+" - Producció ",1)])):k("",!0)]),a("main",et,[a("section",tt,[a("div",null,[C(s(v,{severity:"secondary",class:"button-panel-button",icon:r(h).COG},null,8,["icon"]),[[c,{value:"Canviar estat",showDelay:500,hideDelay:500}]])]),a("div",null,[C(s(v,{severity:"secondary",class:"button-panel-button",icon:r(h).PLAY},null,8,["icon"]),[[c,{value:"Iniciar",showDelay:500,hideDelay:500}]])]),a("div",null,[C(s(v,{severity:"secondary",class:"button-panel-button",icon:r(h).STOP},null,8,["icon"]),[[c,{value:"Parar",showDelay:500,hideDelay:500}]])]),a("div",null,[C(s(v,{severity:"secondary",class:"button-panel-button",icon:r(h).FORWARD},null,8,["icon"]),[[c,{value:"Següent fase",showDelay:500,hideDelay:500}]])])]),a("section",ot,[s(S,{activeIndex:m.value,"onUpdate:activeIndex":u[0]||(u[0]=P=>m.value=P)},{default:d(()=>[s(y,null,{header:d(()=>[a("div",rt,[a("i",{class:D(r(h).CHEVRON_DOWN)},null,2),at])]),default:d(()=>[m.value===0?(f(),$(Ve,{key:0})):k("",!0)]),_:1}),s(y,null,{header:d(()=>[a("div",nt,[a("i",{class:D(r(h).LIST)},null,2),st])]),default:d(()=>[m.value===1?(f(),$(we,{key:0})):k("",!0)]),_:1}),s(y,null,{header:d(()=>[a("div",lt,[a("i",{class:D(r(h).BOX)},null,2),it])]),_:1}),s(y,null,{header:d(()=>[a("div",ct,[a("i",{class:D(r(h).USERS)},null,2),dt])]),default:d(()=>[m.value===3?(f(),$(Ye,{key:0})):k("",!0)]),_:1})]),_:1},8,["activeIndex"])])])])}}});const bt=E(ut,[["__scopeId","data-v-57675b38"]]);export{bt as default};
