import{a8 as z,a as n,c as r,e as i,V as E,a9 as _,aa as T,d as O,k as G,z as U,r as I,M as W,$ as q,o as V,h as $,i as F,w as k,l as o,N as B,ab as j,m as w,ac as R,t as S,P as c,ad as h,n as m,ae as Y,a1 as H,p as J,b as K,f as Q}from"./index-f6af8c81.js";var X={root:"p-toolbar p-component",start:"p-toolbar-group-start p-toolbar-group-left",center:"p-toolbar-group-center",end:"p-toolbar-group-end p-toolbar-group-right"},Z=z.extend({name:"toolbar",classes:X}),ee={name:"BaseToolbar",extends:T,props:{ariaLabelledby:{type:String,default:null}},style:Z,provide:function(){return{$parentInstance:this}}},M={name:"Toolbar",extends:ee,inheritAttrs:!1},te=["aria-labelledby"];function ae(t,l,b,C,d,v){return n(),r("div",_({class:t.cx("root"),role:"toolbar","aria-labelledby":t.ariaLabelledby},t.ptmi("root")),[i("div",_({class:t.cx("start")},t.ptm("start")),[E(t.$slots,"start")],16),i("div",_({class:t.cx("center")},t.ptm("center")),[E(t.$slots,"center")],16),i("div",_({class:t.cx("end")},t.ptm("end")),[E(t.$slots,"end")],16)],16,te)}M.render=ae;const ie=t=>(J("data-v-3e0ce148"),t=t(),K(),t),se={class:"base_input"},oe={class:"file_viewer_title"},le={key:0,class:"file-viewer"},ne={class:"file-viewer-item-type"},re=["onClick"],ce=["onClick"],de=["onClick"],pe=ie(()=>i("div",{id:"img-container"},null,-1)),ue=O({__name:"FileEntityPicker",props:{title:{},entity:{},id:{},maxFiles:{}},setup(t){const l=t,b=G(),C=U(),d=new R,v=I(void 0),p=I(!1),u=W({visible:!1,title:"Detalle de la imagen",closable:!0,position:"center",modal:!0}),f=async()=>{if(!(!l.id||p.value)){p.value=!0;try{v.value=await d.GetEntityFiles(l.entity,l.id)}catch(e){console.error("Error fetching files:",e),b.add({severity:"error",detail:"Error al carregar els arxius"})}finally{p.value=!1}}};q(()=>l.id,(e,s)=>{e&&e!==s&&s!==void 0&&f()}),V(async()=>{l.id&&await f()});const N=()=>{var e;if(!l.maxFiles)return!0;if(v.value)return((e=v.value)==null?void 0:e.length)<l.maxFiles},x=async()=>{const e=document.createElement("input");e.type="file",e.onchange=async s=>{const y=s.target.files[0];if(!await d.Upload(y,l.entity,l.id)){b.add({severity:"error",detail:"Error al carregar l'arxiu"});return}await f()},e.click()},A=async e=>{var a;u.visible=!0;const s=await d.Download(e),y=new Blob([s],{type:"image/jpeg"}),g=await Y(y);(a=document.getElementById("img-container"))==null||a.appendChild(g)},L=async e=>{const s=await d.Download(e);H(e.originalName,s)},P=async e=>{C.require({message:"EstÃ  segur que vol eliminar l'arxiu seleccionat",accept:async()=>{var s=await d.Delete(e.id);if(!s){b.add({severity:"error",detail:"Error al eliminar l'arxiu"});return}await f()}})};return(e,s)=>{const y=$("Button"),g=$("Dialog");return n(),r(B,null,[i("div",se,[F(o(M),null,{start:k(()=>[i("p",oe,S(e.title),1)]),end:k(()=>[F(y,{size:"small",disabled:!N()||p.value,loading:p.value,rounded:"",icon:o(c).UPLOAD,onClick:x},null,8,["disabled","loading","icon"])]),_:1}),p.value?w("",!0):(n(),r("section",le,[(n(!0),r(B,null,j(v.value,a=>(n(),r("article",{class:"file-viewer-item",key:a.id},[i("div",ne,[a.type===o(h).DOCUMENT?(n(),r("i",{key:0,class:m(a.originalName.endsWith("docx")?o(c).FILE_WORD:o(c).FILE_PDF),style:{"font-size":"2.5rem"}},null,2)):w("",!0),a.type===o(h).IMAGE?(n(),r("i",{key:1,class:m(o(c).IMAGE),style:{"font-size":"2.5rem"}},null,2)):w("",!0),i("p",null,S(a.originalName.substring(0,20)),1)]),i("div",{class:m(a.type===o(h).IMAGE?"file-viewer-item-actions-image":"file-viewer-item-actions-file")},[a.type===o(h).IMAGE?(n(),r("div",{key:0,class:"file-viewer-item-action file-viewer-item-action-show",onClick:D=>A(a)},[i("i",{class:m(o(c).EYE),style:{"font-size":"1rem"}},null,2)],8,re)):w("",!0),i("div",{class:"file-viewer-item-action file-viewer-item-action-download",onClick:D=>L(a)},[i("i",{class:m(o(c).DOWNLOAD),style:{"font-size":"1rem"}},null,2)],8,ce),i("div",{class:"file-viewer-item-action file-viewer-item-action-delete",onClick:D=>P(a)},[i("i",{class:m(o(c).TIMES)},null,2)],8,de)],2)]))),128))]))]),F(g,{visible:u.visible,"onUpdate:visible":s[0]||(s[0]=a=>u.visible=a),header:u.title,closable:u.closable,modal:u.modal},{default:k(()=>[pe]),_:1},8,["visible","header","closable","modal"])],64)}}});const ve=Q(ue,[["__scopeId","data-v-3e0ce148"]]);export{ve as F};
