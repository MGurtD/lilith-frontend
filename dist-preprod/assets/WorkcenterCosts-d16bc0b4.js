import{d as F,g as M,u as z,a4 as E,k as T,z as U,o as L,P as p,a5 as R,Y as h,r as P,h as c,q as A,w as u,a as $,e as l,i as a,l as m,I as j,t as H,W as Y,n as G,C as J}from"./index-f6af8c81.js";import{u as K}from"./plantmodel-2dcc063a.js";import"./index-5443ddc0.js";const O={class:"flex flex-wrap align-items-center justify-content-between gap-2"},Q={class:"datatable-filter"},X={class:"filter-field"},Z=l("label",{class:"block text-900 mb-2"},"Màquina",-1),ee={class:"filter-field"},te=l("label",{class:"block text-900 mb-2"},"Cost 0",-1),oe={class:"datatable-buttons"},se=["onClick"],ce=F({__name:"WorkcenterCosts",setup(ae){const f=M(),w=z(),s=K(),_=E(),v=T(),b=U(),C=()=>{const e=_.getFilter("WorkcenterCosts","");e&&(o.value=e)};L(async()=>{w.setMenuItem({icon:p.CALENDAR,title:"Costs per màquina"}),await s.fetchWorkcenterCosts(),await s.fetchWorkcenters(),await s.fetchMachineStatuses(),C()}),R(()=>{_.addFilter("WorkcenterCosts","",o.value)});const g=h(()=>s.workcentercosts?s.workcentercosts.map(e=>({workcenterName:S(e.workcenterId),machineStatusName:B(e.machineStatusId),...e})):[]),o=P({workcenterId:void 0,zerocost:!1}),y=h(()=>{let e=g.value;return o.value.workcenterId&&(e=e.filter(t=>t.workcenterId===o.value.workcenterId)),o.value.zerocost&&(e=e.filter(t=>t.cost===0)),e}),I=()=>{o.value.workcenterId=void 0,o.value.zerocost=!1},S=e=>{var r;const t=(r=s.workcenters)==null?void 0:r.find(i=>i.id===e);if(t)return t.name},B=e=>{var r;const t=(r=s.machineStatuses)==null?void 0:r.find(i=>i.id===e);if(t)return t.name},x=()=>{f.push({path:`/workcentercost/${J()}`})},N=e=>{e.originalEvent.target.className.includes("grid_delete_column_button")||f.push({path:`/workcentercost/${e.data.id}`})},V=(e,t)=>{b.require({target:e.currentTarget,message:`Está segur que vol eliminar el cost  ${t.id}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await s.deleteWorkcenterCost(t.id)&&(v.add({severity:"success",summary:"Eliminat",life:3e3}),await s.fetchWorkcenterCosts())}})};return(e,t)=>{const r=c("Dropdown"),i=c("Checkbox"),k=c("Button"),d=c("Column"),W=c("BooleanColumn"),q=c("DataTable");return $(),A(q,{value:y.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh","sort-field":"workcenterName","sort-order":1,onRowClick:N,paginator:"",rows:12},{header:u(()=>[l("div",O,[l("div",Q,[l("div",X,[Z,a(r,{modelValue:o.value.workcenterId,"onUpdate:modelValue":t[0]||(t[0]=n=>o.value.workcenterId=n),editable:"",options:m(s).workcenters,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),l("div",ee,[te,a(i,{binary:!0,modelValue:o.value.zerocost,"onUpdate:modelValue":t[1]||(t[1]=n=>o.value.zerocost=n)},null,8,["modelValue"])])]),l("div",oe,[a(k,{class:"datatable-button mr-2",icon:m(p).PLUS,rounded:"",raised:"",onClick:x},null,8,["icon"]),a(k,{class:"datatable-button mr-2",icon:m(p).FILTER_SLASH,rounded:"",raised:"",onClick:I},null,8,["icon"])])])]),default:u(()=>[a(d,{field:"workcenterName",header:"Màquina",style:{width:"30%"},sortable:""}),a(d,{field:"machineStatusName",header:"Estat de màquina",style:{width:"30%"}}),a(d,{field:"cost",header:"Cost",style:{width:"30%"}},{body:u(n=>[j(H(m(Y)(n.data.cost)),1)]),_:1}),a(d,{header:"Desactivada",style:{width:"10%"}},{body:u(n=>[a(W,{value:n.data.disabled},null,8,["value"])]),_:1}),a(d,null,{body:u(n=>[l("i",{class:G([m(p).TIMES,"grid_delete_column_button"]),onClick:D=>V(D,n.data)},null,10,se)]),_:1})]),_:1},8,["value"])}}});export{ce as default};
