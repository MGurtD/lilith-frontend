import{d as y,o as E,k as I,E as x,r as B,h as _,l as s,c as N,e as i,i as u,n as V,D as A,m as C,a as h,F as m,x as S,u as g,q as L,P as M,Z as U}from"./index-f6af8c81.js";import{c as $,a as w,F as q}from"./form-validator-ec7c2535.js";import{u as D}from"./plantmodel-2dcc063a.js";import"./index-5443ddc0.js";const R={key:0},P={class:"two-columns"},z={class:"two-columns"},G=i("label",{class:"block text-900 mb-2"},"Local",-1),j=i("label",{class:"block text-900 mb-2"},"Desactivat",-1),O={class:"mt-2"},Z=y({__name:"FormArea",props:{area:{}},emits:["submit","cancel"],setup(k,{emit:c}){const d=k;E(async()=>{await l.fetchSites()});const p=I(),l=D(),{area:e}=x(l),b=$().shape({name:w().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:w().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),siteId:w().required("El local es obligatori")}),r=B({result:!1,errors:{}}),f=()=>{const o=new q(b);r.value=o.validate(d.area)},t=async()=>{if(f(),r.value.result)c("submit",d.area);else{let o="";Object.entries(r.value.errors).forEach(a=>{o+=`${a[1].map(v=>v)}.   `}),p.add({severity:"warn",summary:"Formulari inválid",detail:o,life:5e3})}};return(o,a)=>{const v=_("Dropdown"),F=_("Checkbox"),T=_("Button");return s(e)?(h(),N("form",R,[i("section",P,[u(A,{class:V(["mb-2",{"p-invalid":r.value.errors.name}]),label:"Nom",id:"name",modelValue:s(e).name,"onUpdate:modelValue":a[0]||(a[0]=n=>s(e).name=n)},null,8,["modelValue","class"]),u(A,{class:V(["mb-2",{"p-invalid":r.value.errors.description}]),label:"Descripció",id:"description",modelValue:s(e).description,"onUpdate:modelValue":a[1]||(a[1]=n=>s(e).description=n)},null,8,["modelValue","class"])]),i("section",z,[i("div",null,[G,u(v,{modelValue:s(e).siteId,"onUpdate:modelValue":a[2]||(a[2]=n=>s(e).siteId=n),editable:"",options:s(l).sites,optionValue:"id",optionLabel:"name",class:V(["w-full",{"p-invalid":r.value.errors.siteId}])},null,8,["modelValue","options","class"])]),i("div",null,[j,u(F,{modelValue:s(e).disabled,"onUpdate:modelValue":a[3]||(a[3]=n=>s(e).disabled=n),class:"w-full",binary:!0},null,8,["modelValue"])])]),i("div",O,[u(T,{label:"Guardar",class:"mr-2",onClick:t})])])):C("",!0)}}}),W=y({__name:"Area",setup(k){const c=B(m.EDIT),d=S(),p=g(),l=D(),{area:e}=x(l),b=async()=>{await l.fetchArea(d.params.id);let t="";e.value?(c.value=m.EDIT,t=`Area ${e.value.name}`):(c.value=m.CREATE,l.setNewArea(d.params.id),t="Alta d'area"),p.setMenuItem({icon:M.BUILDING,backButtonVisible:!0,title:t})};E(async()=>{await b()});const r=I(),f=async()=>{const t=e.value;let o=!1,a="";c.value===m.CREATE?(o=await l.createArea(t),a="Area creada correctament"):(o=await l.updateArea(t.id,t),a="Area actualizada correctament"),o&&(r.add({severity:"success",summary:a,life:5e3}),U.back())};return(t,o)=>s(e)?(h(),L(Z,{key:0,area:s(e),onSubmit:f},null,8,["area"])):C("",!0)}});export{W as default};
