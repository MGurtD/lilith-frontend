import{d as y,o as E,k as x,E as C,r as M,h as _,l,c as I,e as o,i as r,n as k,D as S,m as U,a as B,F as p,x as T,u as g,q as A,P as D,Z as N}from"./index-f6af8c81.js";import{c as P,a as h,F as $}from"./form-validator-ec7c2535.js";import{u as q}from"./plantmodel-2dcc063a.js";import"./index-5443ddc0.js";const R={key:0},L={class:"grid_add_row_button"},z={class:"four-columns pt-4"},G=o("label",{class:"block text-900 mb-2"},"Color",-1),O={class:"five-columns"},j=o("label",{class:"block text-900 mb-2"},"Aturada",-1),Z=o("label",{class:"block text-900 mb-2"},"Operaris",-1),H=o("label",{class:"block text-900 mb-2"},"Tancada",-1),J=o("label",{class:"block text-900 mb-2"},"Preferida",-1),K=o("label",{class:"block text-900 mb-2"},"Desactivat",-1),Q=y({__name:"FormMachineStatus",props:{machineStatus:{}},emits:["submit","cancel"],setup(w,{emit:c}){const d=w;E(async()=>{await i.fetchMachineStatuses()});const b=x(),i=q(),{machineStatus:e}=C(i),f=P().shape({name:h().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:h().required("La descripció és obligatoria").max(250,"La descripció pot superar els 250 carácters"),color:h().required("El color es obligatori")}),u=M({result:!1,errors:{}}),V=()=>{const n=new $(f);u.value=n.validate(d.machineStatus)},s=async()=>{if(V(),u.value.result)c("submit",d.machineStatus);else{let n="";Object.entries(u.value.errors).forEach(a=>{n+=`${a[1].map(v=>v)}.   `}),b.add({severity:"warn",summary:"Formulari inválid",detail:n,life:5e3})}};return(n,a)=>{const v=_("Button"),F=_("ColorPicker"),m=_("Checkbox");return l(e)?(B(),I("form",R,[o("div",L,[r(v,{label:"Guardar",style:{float:"right"},onClick:s})]),o("section",z,[r(S,{class:k(["mb-2",{"p-invalid":u.value.errors.name}]),label:"Nom",id:"name",modelValue:l(e).name,"onUpdate:modelValue":a[0]||(a[0]=t=>l(e).name=t)},null,8,["modelValue","class"]),r(S,{class:k(["mb-2",{"p-invalid":u.value.errors.description}]),label:"Descripció",id:"description",modelValue:l(e).description,"onUpdate:modelValue":a[1]||(a[1]=t=>l(e).description=t)},null,8,["modelValue","class"]),o("div",null,[G,r(F,{modelValue:l(e).color,"onUpdate:modelValue":a[2]||(a[2]=t=>l(e).color=t),class:k(["mb-2",{"p-invalid":u.value.errors.color}]),label:"Color",id:"color"},null,8,["modelValue","class"])]),o("div",null,[r(S,{class:"mb-2",label:"Icona",id:"icon",modelValue:l(e).icon,"onUpdate:modelValue":a[3]||(a[3]=t=>l(e).icon=t)},null,8,["modelValue"])])]),o("section",O,[o("div",null,[j,r(m,{modelValue:l(e).stoped,"onUpdate:modelValue":a[4]||(a[4]=t=>l(e).stoped=t),class:"w-full",binary:!0},null,8,["modelValue"])]),o("div",null,[Z,r(m,{modelValue:l(e).operatorsAllowed,"onUpdate:modelValue":a[5]||(a[5]=t=>l(e).operatorsAllowed=t),class:"w-full",binary:!0},null,8,["modelValue"])]),o("div",null,[H,r(m,{modelValue:l(e).closed,"onUpdate:modelValue":a[6]||(a[6]=t=>l(e).closed=t),class:"w-full",binary:!0},null,8,["modelValue"])]),o("div",null,[J,r(m,{modelValue:l(e).preferred,"onUpdate:modelValue":a[7]||(a[7]=t=>l(e).preferred=t),class:"w-full",binary:!0},null,8,["modelValue"])]),o("div",null,[K,r(m,{modelValue:l(e).disabled,"onUpdate:modelValue":a[8]||(a[8]=t=>l(e).disabled=t),class:"w-full",binary:!0},null,8,["modelValue"])])])])):U("",!0)}}}),ae=y({__name:"MachineStatus",setup(w){const c=M(p.EDIT),d=T(),b=g(),i=q(),{machineStatus:e}=C(i),f=async()=>{await i.fetchMachineStatus(d.params.id);let s="";e.value?(c.value=p.EDIT,s=`Estat de màquina ${e.value.name}`):(c.value=p.CREATE,i.setNewMachineStatus(d.params.id),s="Alta d'estat de màquina"),b.setMenuItem({icon:D.BUILDING,backButtonVisible:!0,title:s})};E(async()=>{await f()});const u=x(),V=async()=>{const s=e.value;let n=!1,a="";c.value===p.CREATE?(n=await i.createMachineStatus(s),a="Estat de màquina creat correctament"):(n=await i.updateMachineStatus(s.id,s),a="Estat de màquina actualizat correctament"),n&&(u.add({severity:"success",summary:a,life:5e3}),N.back())};return(s,n)=>l(e)?(B(),A(Q,{key:0,machineStatus:l(e),onSubmit:V},null,8,["machineStatus"])):U("",!0)}});export{ae as default};
