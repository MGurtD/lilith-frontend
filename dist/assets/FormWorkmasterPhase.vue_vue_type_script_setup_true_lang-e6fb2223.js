import{c as C,a as W,F as E}from"./form-validator-f8953ae6.js";import{d as U,j as B,H as g,r as F,h as i,c as N,e as l,i as r,y as u,k as m,n as c,l as _,a as q,s as D}from"./index-53820b8d.js";import{u as L}from"./plantmodel-884a3b96.js";const M={key:0},$=l("br",null,null,-1),j={class:"two-columns-7525 mb-2"},x={class:"three-columns mb-2"},z=l("label",{class:"block text-900 mb-2"},"Tipus de màquina",-1),P=l("label",{class:"block text-900 mb-2"},"Màquina preferida",-1),R=l("label",{class:"block text-900 mb-2"},"Tipus d'operari",-1),S={class:"three-columns mb-2"},G=l("label",{class:"block text-900 mt-1 mb-1"},"Externa",-1),A=U({__name:"FormWorkmasterPhase",props:{workmaster:{},phase:{}},emits:["submit","cancel"],setup(b,{emit:k}){const a=b,h=B(),n=L(),V=g(()=>a.phase.workcenterTypeId?n.getWorkcentersByTypeId(a.phase.workcenterTypeId):[]),f=()=>{a.phase.preferredWorkcenterId=null},v=()=>{a.phase.isExternalWork&&(a.phase.operatorTypeId=null,a.phase.workcenterTypeId=null,a.phase.preferredWorkcenterId=null)},y=C().shape({code:W().required("El codi és obligatori")}),t=F({result:!1,errors:{}}),w=()=>{const e=new E(y);t.value=e.validate(a.phase)},I=async()=>{if(w(),t.value.result)a.phase.preferredWorkcenterId===""&&(a.phase.preferredWorkcenterId=null),k("submit",a.phase);else{let e="";Object.entries(t.value.errors).forEach(o=>{e+=`${o[1].map(d=>d)}.   `}),h.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,o)=>{const d=i("Button"),p=i("Dropdown"),T=i("Checkbox");return e.phase?(q(),N("form",M,[l("div",null,[r(d,{label:"Guardar Fase",class:"grid_add_row_button",size:"small",onClick:I}),$]),l("section",j,[l("div",null,[r(u,{label:"Codi de la fase",modelValue:e.phase.code,"onUpdate:modelValue":o[0]||(o[0]=s=>e.phase.code=s)},null,8,["modelValue"])]),l("div",null,[r(u,{label:"Descripció",modelValue:e.phase.description,"onUpdate:modelValue":o[1]||(o[1]=s=>e.phase.description=s)},null,8,["modelValue"])])]),l("section",x,[l("div",null,[z,r(p,{modelValue:e.phase.workcenterTypeId,"onUpdate:modelValue":o[2]||(o[2]=s=>e.phase.workcenterTypeId=s),editable:"",options:m(n).workcenterTypes,optionValue:"id",optionLabel:"name",class:c(["w-full",{"p-invalid":t.value.errors.workcenterTypeId}]),onChange:f},null,8,["modelValue","options","class"])]),l("div",null,[P,r(p,{modelValue:e.phase.preferredWorkcenterId,"onUpdate:modelValue":o[3]||(o[3]=s=>e.phase.preferredWorkcenterId=s),editable:"",options:V.value,optionValue:"id",optionLabel:"description",class:"w-full"},null,8,["modelValue","options"])]),l("div",null,[R,r(p,{modelValue:e.phase.operatorTypeId,"onUpdate:modelValue":o[4]||(o[4]=s=>e.phase.operatorTypeId=s),editable:"",options:m(n).operatorTypes,optionValue:"id",optionLabel:"description",class:c(["w-full",{"p-invalid":t.value.errors.operatorTypeId}])},null,8,["modelValue","options","class"])])]),l("section",S,[l("div",null,[G,r(T,{modelValue:e.phase.isExternalWork,"onUpdate:modelValue":o[5]||(o[5]=s=>e.phase.isExternalWork=s),class:"w-full",binary:!0,onChange:v},null,8,["modelValue"])]),l("div",null,[r(u,{type:m(D).CURRENCY,label:"Cost extern",modelValue:e.phase.externalWorkCost,"onUpdate:modelValue":o[6]||(o[6]=s=>e.phase.externalWorkCost=s),disabled:!e.phase.isExternalWork,class:c({"p-invalid":t.value.errors.externalWorkCost})},null,8,["type","modelValue","disabled","class"])])])])):_("",!0)}}});export{A as _};
