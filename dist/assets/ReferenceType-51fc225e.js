import{d as R,j as E,r as B,h as b,c as _,e as l,i as n,n as p,z as v,k as V,l as w,a as I,s as F,F as f,g as U,v as N,u as g,C as h,o as D,m as M,P}from"./index-feaddf7a.js";import{c as S,a as k,F as $}from"./form-validator-06627164.js";import{u as A}from"./referenceType-27f1987c.js";const z={key:0},L={class:"three-columns"},j={class:"three-columns"},q=l("label",{class:"block text-900 mb-2"},"Color Primari",-1),G=l("label",{class:"block text-900 mb-2"},"Color Secundari",-1),O=l("label",{class:"block text-900 mb-2"},"Desactivat",-1),H={class:"mt-2"},J=R({__name:"FormReferenceType",props:{referenceType:{}},emits:["submit","cancel"],setup(C,{emit:c}){const d=C,m=E(),y=S().shape({name:k().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:k().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")}),r=B({result:!1,errors:{}}),t=()=>{const e=new $(y);r.value=e.validate(d.referenceType)},T=async()=>{if(t(),r.value.result)c("submit",d.referenceType);else{let e="";Object.entries(r.value.errors).forEach(a=>{e+=`${a[1].map(s=>s)}.   `}),m.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,a)=>{const s=b("ColorPicker"),i=b("Checkbox"),u=b("Button");return e.referenceType?(I(),_("form",z,[l("section",L,[n(v,{class:p(["mb-2",{"p-invalid":r.value.errors.name}]),label:"Nom",id:"name",modelValue:e.referenceType.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.referenceType.name=o)},null,8,["modelValue","class"]),n(v,{class:p(["mb-2",{"p-invalid":r.value.errors.description}]),label:"Descripció",id:"description",modelValue:e.referenceType.description,"onUpdate:modelValue":a[1]||(a[1]=o=>e.referenceType.description=o)},null,8,["modelValue","class"]),l("div",null,[n(v,{type:V(F).NUMERIC,decimals:2,label:"Densitat g/cm^3",id:"density",modelValue:e.referenceType.density,"onUpdate:modelValue":a[2]||(a[2]=o=>e.referenceType.density=o)},null,8,["type","modelValue"])])]),l("section",j,[l("div",null,[q,n(s,{modelValue:e.referenceType.primaryColor,"onUpdate:modelValue":a[3]||(a[3]=o=>e.referenceType.primaryColor=o),class:p(["mb-2",{"p-invalid":r.value.errors.color}]),label:"Color",id:"color"},null,8,["modelValue","class"])]),l("div",null,[G,n(s,{modelValue:e.referenceType.secondaryColor,"onUpdate:modelValue":a[4]||(a[4]=o=>e.referenceType.secondaryColor=o),class:p(["mb-2",{"p-invalid":r.value.errors.color}]),label:"Color",id:"color"},null,8,["modelValue","class"])]),l("div",null,[O,n(i,{modelValue:e.referenceType.disabled,"onUpdate:modelValue":a[5]||(a[5]=o=>e.referenceType.disabled=o),class:"w-full",binary:!0},null,8,["modelValue"])])]),l("div",H,[n(u,{label:"Guardar",class:"mr-2",onClick:T})])])):w("",!0)}}}),X=R({__name:"ReferenceType",setup(C){const c=B(f.EDIT),d=U(),m=N(),y=g(),r=A(),{referenceType:t}=h(r),T=async()=>{await r.fetchReferenceType(m.params.id);let s="";t.value?(c.value=f.EDIT,s=`Tipus de material ${t.value.name}`):(c.value=f.CREATE,r.setNewReferenceType(m.params.id),s="Alta de tipus de materials"),y.setMenuItem({icon:P.BUILDING,backButtonVisible:!0,title:s})};D(async()=>{await T()});const e=E(),a=async()=>{const s=t.value;let i=!1,u="";c.value===f.CREATE?(i=await r.createReferenceType(s),u="Tipus de material creat correctament"):(i=await r.updateReferenceType(s.id,s),u="Tipus de material actualizat correctament"),i&&(e.add({severity:"success",summary:u,life:5e3}),d.back())};return(s,i)=>V(t)?(I(),M(J,{key:0,"reference-type":V(t),onSubmit:a},null,8,["reference-type"])):w("",!0)}});export{X as default};
