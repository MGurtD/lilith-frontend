import{d as L,j,C as se,o as K,r as E,h as D,a as O,c as A,i as l,k as s,e as i,s as R,z as C,n as Q,l as M,D as _e,p as oe,b as re,f as ne,m as X,w as g,Q as Ie,G,H as F,R as Ve,P as Y,T as Re,u as de,V as ue,I as B,J as W,x as Se,v as De,K as ie,F as $,W as Ce}from"./index-3259d18c.js";import{u as Z}from"./receipt-a10a1bdc.js";import{u as Te}from"./suppliers-18e88513.js";import{u as ce}from"./lifecycle-5421a50b.js";import{c as me,a as z,F as pe,d as ke}from"./form-validator-74a9b5a3.js";import{u as Ue}from"./masterData-52715ac7.js";import{L as Oe}from"./LinkReference-f291bcdc.js";import{_ as Ee}from"./DropdownReference.vue_vue_type_script_setup_true_lang-4d725b8f.js";import{u as ee}from"./reference-1e4fc38c.js";import{E as Ne}from"./index-15b73d09.js";import{_ as Pe}from"./FormMaterial.vue_vue_type_script_setup_true_lang-af33f250.js";import{R as J}from"./index-7cbe1881.js";import{u as Ae}from"./order-a19cd42b.js";import{u as Fe}from"./referenceType-cf908f44.js";import"./suppliers.service-9d62a9c5.js";import"./DropdownReferenceType.vue_vue_type_script_setup_true_lang-197dd23f.js";import"./tax-42893cd6.js";import"./plantmodel-b960b490.js";import"./index-1f526e6a.js";const q=S=>(oe("data-v-70931d13"),S=S(),re(),S),xe=q(()=>i("br",null,null,-1)),$e={key:0},Be={class:"three-columns"},We={class:"mt-1"},Le={class:"mt-1"},Me=q(()=>i("label",{class:"block text-900 mb-2"},"Exercici",-1)),qe={class:"mt-1"},Qe=q(()=>i("label",{class:"block text-900 mb-2"},"Data Albarà",-1)),ze={class:"three-columns"},Ge={class:"mt-1"},je=q(()=>i("label",{class:"block text-900 mb-2"},"Estat",-1)),Ke={class:"mt-1"},He=q(()=>i("label",{class:"block text-900 mb-2"},"Proveïdor",-1)),Je={class:"mt-1"},Xe=L({__name:"FormReceipt",emits:["submit","cancel"],setup(S,{expose:U,emit:t}){const T=Z(),I=Te(),v=Ue(),w=ce(),n=j(),{receipt:u}=se(T);K(async()=>{await v.fetchMasterData(),await I.fetchSuppliers(),await w.fetchOneByName("Receipts")});const r=me().shape({supplierId:z().required("El client es obligatori"),statusId:z().required("L'estat es obligatori"),exerciseId:z().required("L'exercici es obligatori")}),V=E({result:!1,errors:{}}),P=()=>{const p=new pe(r);V.value=p.validate(u.value)},k=async()=>{if(P(),V.value.result)u.value.date=_e(u.value.date),t("submit",u.value);else{let p="";Object.entries(V.value.errors).forEach(o=>{p+=`${o[1].map(_=>_)}.   `}),n.add({severity:"warn",summary:"Formulari inválid",detail:p,life:5e3})}};return U({submitForm:k}),(p,o)=>{var y;const _=D("Button"),f=D("Dropdown"),h=D("Calendar");return O(),A("div",null,[l(_,{label:"Guardar",size:"small",class:"grid_add_row_button",onClick:k}),xe,s(u)?(O(),A("form",$e,[i("section",Be,[i("div",We,[l(C,{type:s(R).TEXT,label:"Número",id:"number",modelValue:s(u).number,"onUpdate:modelValue":o[0]||(o[0]=e=>s(u).number=e),disabled:""},null,8,["type","modelValue"])]),i("div",Le,[Me,l(f,{modelValue:s(u).exerciseId,"onUpdate:modelValue":o[1]||(o[1]=e=>s(u).exerciseId=e),editable:"",options:s(v).exercises,optionValue:"id",optionLabel:"name",class:Q(["w-full",{"p-invalid":V.value.errors.exerciseId}])},null,8,["modelValue","options","class"])]),i("div",qe,[Qe,l(h,{modelValue:s(u).date,"onUpdate:modelValue":o[2]||(o[2]=e=>s(u).date=e),dateFormat:"dd/mm/yy"},null,8,["modelValue"])])]),i("section",ze,[i("div",Ge,[je,l(f,{modelValue:s(u).statusId,"onUpdate:modelValue":o[3]||(o[3]=e=>s(u).statusId=e),editable:"",options:(y=s(w).lifecycle)==null?void 0:y.statuses,optionValue:"id",optionLabel:"name",class:Q(["w-full",{"p-invalid":V.value.errors.statusId}])},null,8,["modelValue","options","class"])]),i("div",Ke,[He,l(f,{modelValue:s(u).supplierId,"onUpdate:modelValue":o[4]||(o[4]=e=>s(u).supplierId=e),editable:"",options:s(I).suppliers,optionValue:"id",optionLabel:"comercialName",class:Q(["w-full",{"p-invalid":V.value.errors.customerId}])},null,8,["modelValue","options","class"])]),i("div",Je,[l(C,{type:s(R).TEXT,label:"Número Albarà",id:"supplierNumber",modelValue:s(u).supplierNumber,"onUpdate:modelValue":o[5]||(o[5]=e=>s(u).supplierNumber=e)},null,8,["type","modelValue"])])])])):M("",!0)])}}});const Ye=ne(Xe,[["__scopeId","data-v-70931d13"]]),Ze=["onClick"],et=L({__name:"TableReceiptDetails",props:{details:{}},emits:["edit","delete"],setup(S,{emit:U}){const t=S,T=v=>{v.originalEvent.target.className.includes("grid_delete_column_button")||U("edit",v.data)},I=(v,w)=>{U("delete",w)};return(v,w)=>{const n=D("Column"),u=D("DataTable");return O(),X(u,{onRowClick:T,value:t.details,tableStyle:"min-width: 100%",class:"p-datatable-sm","sort-mode":"single","sort-field":"reference.code","sort-order":1},{header:g(()=>[Ie(v.$slots,"header")]),default:g(()=>[l(n,{field:"quantity",header:"Quantitat",style:{width:"7.5%"}}),l(n,{sortable:"",header:"Referència",field:"reference.code",style:{width:"20%"}},{body:g(({data:r})=>[l(Oe,{id:r.referenceId,"full-name":!0},null,8,["id"])]),_:1}),l(n,{field:"description",header:"Descripció",style:{width:"20%"}}),l(n,{field:"width",header:"Amplada",style:{width:"7.5%"}}),l(n,{field:"height",header:"Alçada",style:{width:"7.5%"}}),l(n,{field:"lenght",header:"Longitud",style:{width:"7.5%"}}),l(n,{field:"thickness",header:"Gruix",style:{width:"7.5%"}}),l(n,{field:"diameter",header:"Diàmetre",style:{width:"7.5%"}}),l(n,{field:"totalWeight",header:"Pes",style:{width:"7.5%"}},{body:g(r=>[G(F(r.data.totalWeight)+" KG",1)]),_:1}),l(n,{field:"amount",header:"Preu",style:{width:"7.5%"}},{body:g(r=>[G(F(s(Ve)(r.data.amount)),1)]),_:1}),l(n,{style:{width:"5%"}},{body:g(r=>[r.data.stockMovementId===null?(O(),A("i",{key:0,class:Q([s(Y).TIMES,"grid_delete_column_button"]),onClick:V=>I(V,r.data)},null,10,Ze)):M("",!0)]),_:1})]),_:3},8,["value"])}}}),tt={key:0},lt={class:"three-columns-7525"},at={class:"three-columns mt-2"},it={class:"three-columns mt-2"},st={class:"three-columns mt-2"},ot=L({__name:"FormReceiptDetail",props:{detail:{},receipt:{}},emits:["submit","cancel"],setup(S,{emit:U}){const t=S,T=j(),I=Z(),v=ee(),w=new Re("/reference"),n=E(""),u=async e=>{var b,d;if(!(e==null||t.receipt.supplierId=="")){var a=await Ne.Supplier.getSupplierReferenceBySupplierIdAndReferenceId(t.receipt.supplierId,e);a&&n.value!="UNITATS"?t.detail.kilogramPrice=a.supplierPrice:a&&n.value=="UNITATS"?t.detail.unitPrice=a.supplierPrice:!a&&n.value!="UNITATS"?v.reference&&(t.detail.kilogramPrice=(b=v.reference)==null?void 0:b.price):v.reference&&(t.detail.unitPrice=(d=v.reference)==null?void 0:d.price)}},r=async e=>{if(await v.fetchReference(t.detail.referenceId),v.reference&&v.reference.referenceFormatId!=null){const a=await w.getReferenceFormatById(v.reference.referenceFormatId);a&&(n.value=a.code)}};K(async()=>{await r(t.detail.referenceId)});const V=async e=>{if(t.detail.description==""||t.detail.description==null){const a=await v.getFullNameById(e);t.detail.description=a}},P=async e=>{e==null||t.receipt.supplierId==""||(await k(),await r(),await u(e),await V(e))},k=async()=>{t.detail.thickness=0,t.detail.lenght=0,t.detail.diameter=0,t.detail.height=0,t.detail.kilogramPrice=0,t.detail.quantity=0,t.detail.totalWeight=0,t.detail.width=0,t.detail.unitPrice=0,t.detail.unitWeight=0,t.detail.amount=0},p=e=>n.value==="UNITATS"?e==="thickness"||e==="width"||e==="height"||e==="kilogramprice"||e==="length"||e==="diameter"||e==="thickness"||e==="totalweight":n.value==="RODO"?e==="thickness"||e==="width"||e==="height"||e==="totalweight":n.value==="TUB"?e==="width"||e==="height"||e==="totalweight":n.value==="PLACA"?e==="thickness"||e==="diameter"||e==="totalweight":!1,o=async()=>{if(n.value=="RODO"&&t.detail.diameter!=0&&t.detail.lenght!=0){const e=await I.calculateDetailWeightAndPrice(t.detail);e.result?(t.detail.unitWeight=e.content.unitWeight,t.detail.totalWeight=e.content.totalWeight,t.detail.unitPrice=e.content.unitPrice,t.detail.amount=e.content.amount):T.add({summary:"Calculadora de pes/preu",detail:e.errors[0],severity:"warn",life:6e3})}else if(n.value=="TUB"&&t.detail.diameter!=0&&t.detail.lenght!=0&&t.detail.thickness!=0){const e=await I.calculateDetailWeightAndPrice(t.detail);e.result?(t.detail.unitWeight=e.content.unitWeight,t.detail.totalWeight=e.content.totalWeight,t.detail.unitPrice=e.content.unitPrice,t.detail.amount=e.content.amount):T.add({summary:"Calculadora de pes/preu",detail:e.errors[0],severity:"warn",life:6e3})}else if(n.value=="PLACA"&&t.detail.lenght!=0&&t.detail.width!=0&&t.detail.height!=0){const e=await I.calculateDetailWeightAndPrice(t.detail);e.result?(t.detail.unitWeight=e.content.unitWeight,t.detail.totalWeight=e.content.totalWeight,t.detail.unitPrice=e.content.unitPrice,t.detail.amount=e.content.amount):T.add({summary:"Calculadora de pes/preu",detail:e.errors[0],severity:"warn",life:6e3})}else n.value=="UNITATS"&&(t.detail.amount=t.detail.unitPrice*t.detail.quantity)},_=me().shape({quantity:ke().min(1).required("La quantitat ha de ser superior a 1"),referenceId:z().required("La referencia és obligatoria")}),f=E({result:!1,errors:{}}),h=()=>{const e=new pe(_);f.value=e.validate(t.detail)},y=async()=>{if(h(),f.value.result)U("submit",t.detail);else{let e="";Object.entries(f.value.errors).forEach(a=>{e+=`${a[1].map(b=>b)}.   `}),T.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,a)=>{const b=D("Button");return e.detail?(O(),A("form",tt,[i("section",lt,[i("div",null,[l(Ee,{label:"Referència de compra",modelValue:e.detail.referenceId,"onUpdate:modelValue":[a[0]||(a[0]=d=>e.detail.referenceId=d),P],fullName:!0},null,8,["modelValue"])]),i("div",null,[l(C,{type:s(R).TEXT,label:"Format",modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=d=>n.value=d),disabled:""},null,8,["type","modelValue"])]),i("div",null,[l(C,{type:s(R).CURRENCY,label:"Preu / Kilo",highlightOnFocus:"",modelValue:e.detail.kilogramPrice,"onUpdate:modelValue":[a[2]||(a[2]=d=>e.detail.kilogramPrice=d),o],disabled:p("kilogramprice")},null,8,["type","modelValue","disabled"])])]),i("section",null,[i("div",null,[l(C,{type:s(R).TEXT,label:"Descripció",highlightOnFocus:"",modelValue:e.detail.description,"onUpdate:modelValue":a[3]||(a[3]=d=>e.detail.description=d)},null,8,["type","modelValue"])])]),i("section",at,[i("div",null,[l(C,{type:s(R).NUMERIC,highlightOnFocus:"",label:"Amplada (mm)",decimals:2,modelValue:e.detail.width,"onUpdate:modelValue":[a[4]||(a[4]=d=>e.detail.width=d),o],disabled:p("width")},null,8,["type","modelValue","disabled"])]),i("div",null,[l(C,{type:s(R).NUMERIC,decimals:2,label:"Alçada (mm)",highlightOnFocus:"",modelValue:e.detail.height,"onUpdate:modelValue":[a[5]||(a[5]=d=>e.detail.height=d),o],disabled:p("height")},null,8,["type","modelValue","disabled"])]),i("div",null,[l(C,{type:s(R).NUMERIC,decimals:2,label:"Longitud (mm)",highlightOnFocus:"",modelValue:e.detail.lenght,"onUpdate:modelValue":[a[6]||(a[6]=d=>e.detail.lenght=d),o],disabled:p("length")},null,8,["type","modelValue","disabled"])])]),i("section",it,[i("div",null,[l(C,{type:s(R).NUMERIC,decimals:2,label:"Diàmetre (mm)",highlightOnFocus:"",modelValue:e.detail.diameter,"onUpdate:modelValue":[a[7]||(a[7]=d=>e.detail.diameter=d),o],disabled:p("diameter")},null,8,["type","modelValue","disabled"])]),i("div",null,[l(C,{type:s(R).NUMERIC,decimals:2,label:"Gruix (mm)",highlightOnFocus:"",modelValue:e.detail.thickness,"onUpdate:modelValue":[a[8]||(a[8]=d=>e.detail.thickness=d),o],disabled:p("thickness")},null,8,["type","modelValue","disabled"])]),i("div",null,[l(C,{type:s(R).NUMERIC,decimals:2,label:"Pes (kg)",modelValue:e.detail.totalWeight,"onUpdate:modelValue":a[9]||(a[9]=d=>e.detail.totalWeight=d),disabled:p("totalweight")},null,8,["type","modelValue","disabled"])])]),i("section",st,[i("div",null,[l(C,{type:s(R).NUMERIC,label:"Quantitat",highlightOnFocus:"",modelValue:e.detail.quantity,"onUpdate:modelValue":[a[10]||(a[10]=d=>e.detail.quantity=d),o]},null,8,["type","modelValue"])]),i("div",null,[l(C,{type:s(R).CURRENCY,label:"Preu unitari",highlightOnFocus:"",modelValue:e.detail.unitPrice,"onUpdate:modelValue":[a[11]||(a[11]=d=>e.detail.unitPrice=d),o]},null,8,["type","modelValue"])]),i("div",null,[l(C,{type:s(R).CURRENCY,label:"Preu",modelValue:e.detail.amount,"onUpdate:modelValue":a[12]||(a[12]=d=>e.detail.amount=d)},null,8,["type","modelValue"])])]),l(b,{label:"Crear",onClick:y,style:{float:"right"},size:"small",class:"mt-2"})])):M("",!0)}}}),fe=S=>(oe("data-v-fb72287c"),S=S(),re(),S),rt={class:"selector-filter"},nt={class:"selector-filter-field"},dt=fe(()=>i("label",{for:""},"Buscar",-1)),ut=fe(()=>i("label",null,"Import",-1)),ct={key:0},mt=L({__name:"SelectorOrdersDetailsToReceipt",props:{receipt:{},groupedOrderDetails:{}},emits:["selected"],setup(S,{emit:U}){const t=S,T=j(),I=de(),v=ee(),w=E({}),n=E(""),u=E([]),r=ue(()=>{var p=[];if(t.groupedOrderDetails)try{p=t.groupedOrderDetails.filter(o=>o.reference.code.includes(n.value))}catch(o){console.error("Error filtering orders",o)}return p}),V=()=>{t.groupedOrderDetails&&(w.value=t.groupedOrderDetails.reduce((p,o)=>(p[o.reference.id]=!0,p),{}))};K(()=>{if(!t.groupedOrderDetails){console.error("No orders to show");return}V()});const P=()=>u.value.length===0?(T.add({severity:"warn",summary:"Selecció inválida",detail:"Selecciona alguna línia per afegir-la a l'albarà",life:6e3}),!1):u.value.some(p=>p.pendingQuantity===0)?(T.add({severity:"warn",summary:"Selecció inválida",detail:"No es poden afegir línies amb quantitat 0",life:6e3}),!1):!0,k=()=>{if(!t.groupedOrderDetails||!P())return;const p={receiptId:t.receipt.id,receptions:[]};JSON.parse(JSON.stringify(t.groupedOrderDetails)).map(f=>(f.details=u.value.filter(h=>f.details.some(y=>y.id===h.id)),f)).forEach(f=>{const h=f.details.reduce((y,e)=>y+e.pendingQuantity,0);console.log("Total quantity",h),console.log("Price",f.price),f.details.forEach(y=>{var e;console.log("Detail price",y.pendingQuantity,f.price/h*y.pendingQuantity),p.receptions.push({receiptDetailId:W(),purchaseOrderDetailId:y.id,quantity:y.pendingQuantity,price:h>0?f.price/h*y.pendingQuantity:0,user:(e=I.user)==null?void 0:e.username})})}),U("selected",p)};return(p,o)=>{const _=D("InputText"),f=D("Button"),h=D("Column"),y=D("BaseInput"),e=D("DataTable");return O(),X(e,{class:"p-datatable-sm",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"75vh",dataKey:"reference.id",expandedRows:w.value,"onUpdate:expandedRows":o[2]||(o[2]=a=>w.value=a),value:r.value},{header:g(()=>[i("header",rt,[i("div",nt,[dt,G("   "),l(_,{style:{width:"250px",height:"35px"},placeholder:"Comanda, OF o referència",modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=a=>n.value=a),size:"small"},null,8,["modelValue"])]),i("div",null,[i("div",null,[l(f,{onClick:k,size:"small",icon:s(Y).CHECK_SQUARE,label:"Afegir"},null,8,["icon"])])])])]),expansion:g(({data:a})=>[l(e,{class:"p-datatable-sm",value:a.details,selection:u.value,"onUpdate:selection":o[1]||(o[1]=b=>u.value=b)},{default:g(()=>[l(h,{selectionMode:"multiple",headerStyle:"width: 2%"}),l(h,{header:"Comanda",field:"orderNumber",headerStyle:"width: 15%"}),l(h,{header:"D. Prevista",field:"expectedReceiptDate",headerStyle:"width: 15%"},{body:g(({data:b})=>[G(F(s(B)(b.expectedReceiptDate)),1)]),_:2},1024),l(h,{header:"OF",field:"workOrder",headerStyle:"width: 60%"},{body:g(({data:b})=>[b.workOrder.length>0?(O(),A("span",ct,F(`${b.workOrder} - ${b.workOrderPhase}`),1)):M("",!0)]),_:2},1024),l(h,{header:"Quantitat pendent",headerStyle:"width: 10%"},{body:g(({data:b})=>[l(y,{style:{width:"250px",height:"35px"},type:s(R).NUMERIC,min:0,max:b.pendingQuantity,modelValue:b.pendingQuantity,"onUpdate:modelValue":d=>b.pendingQuantity=d},null,8,["type","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["value","selection"])]),default:g(()=>[l(h,{expander:"",style:{width:"5%"}}),l(h,{header:"",field:"number",style:{width:"85%"}},{body:g(({data:a})=>[i("b",null,F(s(v).getFullNameById(a.reference.id))+" | "+F(a.description),1)]),_:1}),l(h,{header:"",field:"number",style:{width:"10%"}},{body:g(({data:a})=>[i("div",null,[ut,l(y,{type:s(R).CURRENCY,style:{width:"250px",height:"35px"},modelValue:a.price,"onUpdate:modelValue":b=>a.price=b,placeholder:"Import (€)"},null,8,["type","modelValue","onUpdate:modelValue"])])]),_:1})]),_:1},8,["expandedRows","value"])}}});const pt=ne(mt,[["__scopeId","data-v-fb72287c"]]),ft={key:0},ht=i("br",null,null,-1),vt={class:"flex flex-wrap align-items-center justify-content-between gap-2"},yt=i("span",{class:"text-xl text-900 font-bold"},"Detall de l'albarà",-1),bt={class:"flex flex-wrap align-items-center justify-content-between gap-2"},gt={key:1},Bt=L({__name:"Receipt",setup(S){const U=Se(),t=De(),T=de(),I=ee(),v=Fe(),w=Z(),n=Ae(),u=ce(),{receipt:r}=se(w),V=E(0),P=async()=>{var c;await w.fetchReceipt(t.params.id),u.fetchOneByName("Receipts"),I.fetchReferencesByModule("purchase"),v.fetchActive(),r.value&&(r.value.date=B(r.value.date)),T.setMenuItem({icon:Y.BUILDING,title:`Albarà de recepció ${(c=r.value)==null?void 0:c.number}`,backButtonVisible:!0})};K(async()=>{await P()});const k=j(),p=ue(()=>{var m;if(!u.lifecycle)return!1;const c=u.lifecycle.statuses.find(N=>N.name==="Recepcionat");return c?((m=r.value)==null?void 0:m.statusId)===c.id:!1}),o=async()=>{let c=!1,m="";r.value&&(c=await w.updateReceipt(r.value.id,r.value),m="Albarà actualizat correctament",c&&(k.add({severity:"success",summary:m,life:5e3}),Ce.back()))},_=ie({visible:!1,title:"Linea",closable:!0,position:"center",modal:!0}),f=ie({visible:!1,title:"Selecció de comandes",closable:!0,position:"center",modal:!0}),h=E($.CREATE),y=E({}),e=()=>{h.value=$.CREATE,y.value={id:W(),receiptId:r.value.id,amount:0,diameter:0,height:0,kilogramPrice:0,lenght:0,quantity:1,thickness:0,totalWeight:0,unitPrice:0,unitWeight:0,width:0,disabled:!1},I.setNewReference(W(),J.MATERIAL),_.title="Crear línia",_.visible=!0},a=c=>{h.value=$.EDIT,y.value=c,I.setNewReference(W(),J.MATERIAL),_.title="Modificar línia",_.visible=!0},b=c=>{h.value===$.CREATE?d(c):h.value===$.EDIT&&he(c),_.visible=!1},d=async c=>{const m=await w.createReceiptDetail(c);r.value.date=B(r.value.date),m.result||H(m)},he=async c=>{const m=await w.updateReceiptDetail(c.id,c);r.value.date=B(r.value.date),m.result||H(m)},ve=async c=>{U.require({message:"Está segur que vols la línia?",icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{const m=await w.deleteReceiptDetail(c.id);r.value.date=B(r.value.date),m.result||H(m)}})},H=c=>{k.add({severity:"error",summary:c.errors[0],life:1e4,closable:!0})},ye=async c=>{let m=!1,N="";m=await I.createReference(c),m?N="Referència creada correctament":N="La referència + versió introduïda ja existeix",k.add({severity:m?"success":"warn",summary:N,life:5e3}),m&&(y.value.referenceId=c.id,V.value=0,I.setNewReference(W(),J.MATERIAL))},be=async()=>{await n.fetchOrdersToReceiptBySupplier(r.value.supplierId),f.visible=!0},ge=async c=>{if(!c){f.visible=!1;return}f.visible=!1;const m=await w.addReceptions(c);m.result?(k.add({severity:"success",summary:"Recepcions afegides correctament",life:5e3}),w.fetchReceiptDetails(c.receiptId)):k.add({severity:"error",summary:m.errors[0],life:1e4,closable:!0})};return(c,m)=>{var ae;const N=D("Button"),te=D("Dialog"),le=D("TabPanel"),we=D("TabView");return s(r)?(O(),A("main",ft,[l(Ye,{onSubmit:o}),ht,l(et,{details:(ae=s(r))==null?void 0:ae.details,onEdit:a,onDelete:ve},{header:g(()=>[i("div",vt,[yt,i("div",bt,[i("div",null,[l(N,{size:"small",label:"Afegir de comanda",disabled:p.value,onClick:be},null,8,["disabled"])]),i("div",null,[l(N,{size:"small",label:"Afegir línia",disabled:p.value,onClick:e},null,8,["disabled"])])])])]),_:1},8,["details"]),l(te,{visible:f.visible,"onUpdate:visible":m[0]||(m[0]=x=>f.visible=x),header:f.title,closable:f.closable,modal:f.modal,style:{width:"60vw"}},{default:g(()=>[l(pt,{receipt:s(r),groupedOrderDetails:s(n).ordersToReceipt,onSelected:ge},null,8,["receipt","groupedOrderDetails"])]),_:1},8,["visible","header","closable","modal"]),l(te,{visible:_.visible,"onUpdate:visible":m[2]||(m[2]=x=>_.visible=x),header:_.title,closable:_.closable,modal:_.modal},{default:g(()=>[l(we,{activeIndex:V.value,"onUpdate:activeIndex":m[1]||(m[1]=x=>V.value=x)},{default:g(()=>[l(le,{header:"Línea"},{default:g(()=>[l(ot,{detail:y.value,receipt:s(r),onSubmit:b},null,8,["detail","receipt"])]),_:1}),l(le,{header:"Referencia"},{default:g(()=>[s(I).reference?(O(),X(Pe,{key:0,reference:s(I).reference,onSubmit:ye},null,8,["reference"])):M("",!0)]),_:1})]),_:1},8,["activeIndex"])]),_:1},8,["visible","header","closable","modal"])])):(O(),A("main",gt,"Carregant albarà ..."))}}});export{Bt as default};
