import{_ as N}from"./DropdownReferenceType.vue_vue_type_script_setup_true_lang-9e3d459e.js";import{d as S,r as $,K as A,h as y,m as R,w as c,a as x,e as r,i as a,y as U,k as h,P as v,D as C,C as j,n as q,p as P,b as H,f as D,g as K,u as z,x as G,j as J,o as O}from"./index-3b4220ae.js";import{u as B}from"./reference-6a04c674.js";import{u as M}from"./referenceType-b816b5e5.js";import{g as Q}from"./functions-2e154ea4.js";import{u as W}from"./tax-a88963ec.js";import"./reference.service-f49a3be3.js";import"./base.service-44647e51.js";import"./index-4435bf5b.js";import"./_commonjsHelpers-725317a4.js";import"./v4-a960c1f4.js";const k=i=>(P("data-v-7407545a"),i=i(),H(),i),X={class:"flex flex-wrap align-items-center justify-content-between gap-2"},Y={class:"datatable-filter"},Z={class:"filter-field"},ee=k(()=>r("label",null,"Codi",-1)),te={class:"filter-field"},oe=k(()=>r("label",null,"Tipus",-1)),se={class:"datatable-buttons"},ae=["onClick"],re=S({__name:"TableMaterials",props:{references:{}},emits:["add","edit","delete"],setup(i,{emit:d}){const _=i,u=M(),T=B(),s=$({code:"",referenceTypeId:""}),b=()=>{s.value.code="",s.value.referenceTypeId=""},m=A(()=>{if(!_.references)return[];let t=_.references;return s.value.referenceTypeId.length>0&&(t=t.filter(e=>e.referenceTypeId===s.value.referenceTypeId)),s.value.code.length>0&&(t=t.filter(e=>e.code.toLowerCase().includes(s.value.code.toLowerCase()))),t}),I=()=>{d("add")},g=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||d("edit",t.data)},w=(t,e)=>{d("delete",e)},n=t=>{const e=u.getReferenceTypeById(t);return e?e.density:0},p=t=>{var f;const e=(f=T.referenceFormats)==null?void 0:f.find(l=>l.id===t);return e?e.description:""},V=t=>{const e=u.getReferenceTypeById(t);return e?e.description:""};return(t,e)=>{const f=y("Button"),l=y("Column"),F=y("BooleanColumn"),E=y("DataTable");return x(),R(E,{value:m.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",paginator:"",rows:12,onRowClick:g},{header:c(()=>[r("div",X,[r("div",Y,[r("div",Z,[ee,a(U,{modelValue:s.value.code,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.code=o)},null,8,["modelValue"])]),r("div",te,[oe,a(N,{label:"",modelValue:s.value.referenceTypeId,"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.referenceTypeId=o)},null,8,["modelValue"])])]),r("div",se,[a(f,{class:"datatable-button mr-2",icon:h(v).FILTER_SLASH,rounded:"",raised:"",onClick:b},null,8,["icon"]),a(f,{class:"datatable-button mr-2",icon:h(v).PLUS,rounded:"",raised:"",onClick:I},null,8,["icon"])])])]),default:c(()=>[a(l,{field:"code",header:"Codi",style:{width:"15%"}}),a(l,{field:"description",header:"Descripció",style:{width:"25%"}}),a(l,{field:"referenceTypeId",header:"Tipus",style:{width:"30%"}},{body:c(o=>[r("span",null,C(V(o.data.referenceTypeId)),1)]),_:1}),a(l,{header:"Densitat (mm)",style:{width:"10%"}},{body:c(o=>[j(C(n(o.data.referenceTypeId)),1)]),_:1}),a(l,{field:"referenceFormatId",header:"Format",style:{width:"10%"}},{body:c(o=>[r("span",null,C(p(o.data.referenceFormatId)),1)]),_:1}),a(l,{header:"Desc.",style:{width:"10%"}},{body:c(o=>[a(F,{value:o.data.disabled},null,8,["value"])]),_:1}),a(l,{style:{width:"10%"}},{body:c(o=>[r("i",{class:q([h(v).TIMES,"grid_delete_column_button"]),onClick:L=>w(L,o.data)},null,10,ae)]),_:1})]),_:1},8,["value"])}}});const ne=D(re,[["__scopeId","data-v-7407545a"]]),le=S({__name:"Materials",setup(i){const d=K(),_=z(),u=B(),T=W(),s=M(),b=G(),m=J();O(async()=>{let n="Materials de compra";_.setMenuItem({icon:v.TICKET,title:n}),await u.fetchReferencesByModule("purchase"),T.fetchAll(),s.fetchAll()});const I=()=>{d.push({path:`/material/${Q()}`})},g=n=>{d.push({path:`/material/${n.id}`})},w=n=>{b.require({message:`Está segur que vol eliminar el material ${n.description}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{const p=await u.deleteReference(n.id);p.result?m.add({severity:"success",summary:"Material eliminat correctament",life:5e3}):m.add({severity:"warn",summary:p.errors[0],life:5e3,closable:!0})}})};return(n,p)=>(x(),R(ne,{references:h(u).references,onAdd:I,onEdit:g,onDelete:w},null,8,["references"]))}});const Te=D(le,[["__scopeId","data-v-366c5f01"]]);export{Te as default};
