import{d as M,g as q,u as E,j as T,x as W,o as z,P as p,K as k,r as L,h as c,m as R,w as u,a as P,e as l,i as a,k as m,C as j,D as A,n as U}from"./index-0c51ec9c.js";import{u as $}from"./plantmodel-f7819718.js";import{d as F}from"./functions-2e154ea4.js";import{v as H}from"./v4-a960c1f4.js";import"./index-3b48b213.js";import"./base.service-ebedc193.js";import"./_commonjsHelpers-725317a4.js";const K={class:"flex flex-wrap align-items-center justify-content-between gap-2"},G={class:"datatable-filter"},J={class:"filter-field"},O=l("label",{class:"block text-900 mb-2"},"Màquina",-1),Q={class:"filter-field"},X=l("label",{class:"block text-900 mb-2"},"Cost 0",-1),Y={class:"datatable-buttons"},Z=["onClick"],ce=M({__name:"WorkcenterCosts",setup(ee){const f=q(),h=E(),o=$(),w=T(),b=W();z(async()=>{await o.fetchWorkcenterCosts(),await o.fetchWorkcenters(),await o.fetchMachineStatuses(),h.setMenuItem({icon:p.CALENDAR,title:"Costs per màquina"})});const v=k(()=>o.workcentercosts?o.workcentercosts.map(e=>({workcenterName:I(e.workcenterId),machineStatusName:g(e.machineStatusId),...e})):[]),s=L({workcenterId:void 0,zerocost:!1}),C=k(()=>{let e=v.value;return s.value.workcenterId&&(e=e.filter(t=>t.workcenterId===s.value.workcenterId)),s.value.zerocost&&(e=e.filter(t=>t.cost===0)),e}),y=()=>{s.value.workcenterId=void 0,s.value.zerocost=!1},I=e=>{var r;const t=(r=o.workcenters)==null?void 0:r.find(i=>i.id===e);if(t)return t.name},g=e=>{var r;const t=(r=o.machineStatuses)==null?void 0:r.find(i=>i.id===e);if(t)return t.name},S=()=>{f.push({path:`/workcentercost/${H()}`})},x=e=>{e.originalEvent.target.className.includes("grid_delete_column_button")||f.push({path:`/workcentercost/${e.data.id}`})},B=(e,t)=>{b.require({target:e.currentTarget,message:`Está segur que vol eliminar el cost  ${t.id}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await o.deleteWorkcenterCost(t.id)&&(w.add({severity:"success",summary:"Eliminat",life:3e3}),await o.fetchWorkcenterCosts())}})};return(e,t)=>{const r=c("Dropdown"),i=c("Checkbox"),_=c("Button"),d=c("Column"),N=c("BooleanColumn"),V=c("DataTable");return P(),R(V,{value:C.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh","sort-field":"workcenterName","sort-order":1,onRowClick:x,paginator:"",rows:12},{header:u(()=>[l("div",K,[l("div",G,[l("div",J,[O,a(r,{modelValue:s.value.workcenterId,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.workcenterId=n),editable:"",options:m(o).workcenters,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),l("div",Q,[X,a(i,{binary:!0,modelValue:s.value.zerocost,"onUpdate:modelValue":t[1]||(t[1]=n=>s.value.zerocost=n)},null,8,["modelValue"])])]),l("div",Y,[a(_,{class:"datatable-button mr-2",icon:m(p).PLUS,rounded:"",raised:"",onClick:S},null,8,["icon"]),a(_,{class:"datatable-button mr-2",icon:m(p).FILTER_SLASH,rounded:"",raised:"",onClick:y},null,8,["icon"])])])]),default:u(()=>[a(d,{field:"workcenterName",header:"Màquina",style:{width:"30%"},sortable:""}),a(d,{field:"machineStatusName",header:"Estat de màquina",style:{width:"30%"}}),a(d,{field:"cost",header:"Cost",style:{width:"30%"}},{body:u(n=>[j(A(m(F)(n.data.cost)),1)]),_:1}),a(d,{header:"Desactivada",style:{width:"10%"}},{body:u(n=>[a(N,{value:n.data.disabled},null,8,["value"])]),_:1}),a(d,null,{body:u(n=>[l("i",{class:U([m(p).TIMES,"grid_delete_column_button"]),onClick:D=>B(D,n.data)},null,10,Z)]),_:1})]),_:1},8,["value"])}}});export{ce as default};
