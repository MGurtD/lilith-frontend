import{d as M,g as q,u as E,$ as T,j as z,x as R,o as U,P as p,a0 as L,V as h,r as P,h as c,m as $,w as u,a as j,e as l,i as a,k as m,G as A,H,R as G,n as J,y as K}from"./index-eea64e26.js";import{u as O}from"./plantmodel-756ce4ca.js";import"./index-56fae9cf.js";const Q={class:"flex flex-wrap align-items-center justify-content-between gap-2"},X={class:"datatable-filter"},Y={class:"filter-field"},Z=l("label",{class:"block text-900 mb-2"},"Màquina",-1),ee={class:"filter-field"},te=l("label",{class:"block text-900 mb-2"},"Cost 0",-1),oe={class:"datatable-buttons"},se=["onClick"],ce=M({__name:"WorkcenterCosts",setup(ae){const f=q(),w=E(),s=O(),_=T(),v=z(),b=R(),C=()=>{const e=_.getFilter("WorkcenterCosts","");e&&(o.value=e)};U(async()=>{w.setMenuItem({icon:p.CALENDAR,title:"Costs per màquina"}),await s.fetchWorkcenterCosts(),await s.fetchWorkcenters(),await s.fetchMachineStatuses(),C()}),L(()=>{_.addFilter("WorkcenterCosts","",o.value)});const y=h(()=>s.workcentercosts?s.workcentercosts.map(e=>({workcenterName:I(e.workcenterId),machineStatusName:x(e.machineStatusId),...e})):[]),o=P({workcenterId:void 0,zerocost:!1}),g=h(()=>{let e=y.value;return o.value.workcenterId&&(e=e.filter(t=>t.workcenterId===o.value.workcenterId)),o.value.zerocost&&(e=e.filter(t=>t.cost===0)),e}),S=()=>{o.value.workcenterId=void 0,o.value.zerocost=!1},I=e=>{var r;const t=(r=s.workcenters)==null?void 0:r.find(i=>i.id===e);if(t)return t.name},x=e=>{var r;const t=(r=s.machineStatuses)==null?void 0:r.find(i=>i.id===e);if(t)return t.name},B=()=>{f.push({path:`/workcentercost/${K()}`})},V=e=>{e.originalEvent.target.className.includes("grid_delete_column_button")||f.push({path:`/workcentercost/${e.data.id}`})},N=(e,t)=>{b.require({target:e.currentTarget,message:`Está segur que vol eliminar el cost  ${t.id}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await s.deleteWorkcenterCost(t.id)&&(v.add({severity:"success",summary:"Eliminat",life:3e3}),await s.fetchWorkcenterCosts())}})};return(e,t)=>{const r=c("Dropdown"),i=c("Checkbox"),k=c("Button"),d=c("Column"),W=c("BooleanColumn"),D=c("DataTable");return j(),$(D,{value:g.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh","sort-field":"workcenterName","sort-order":1,onRowClick:V,paginator:"",rows:12},{header:u(()=>[l("div",Q,[l("div",X,[l("div",Y,[Z,a(r,{modelValue:o.value.workcenterId,"onUpdate:modelValue":t[0]||(t[0]=n=>o.value.workcenterId=n),editable:"",options:m(s).workcenters,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),l("div",ee,[te,a(i,{binary:!0,modelValue:o.value.zerocost,"onUpdate:modelValue":t[1]||(t[1]=n=>o.value.zerocost=n)},null,8,["modelValue"])])]),l("div",oe,[a(k,{class:"datatable-button mr-2",icon:m(p).PLUS,rounded:"",raised:"",onClick:B},null,8,["icon"]),a(k,{class:"datatable-button mr-2",icon:m(p).FILTER_SLASH,rounded:"",raised:"",onClick:S},null,8,["icon"])])])]),default:u(()=>[a(d,{field:"workcenterName",header:"Màquina",style:{width:"30%"},sortable:""}),a(d,{field:"machineStatusName",header:"Estat de màquina",style:{width:"30%"}}),a(d,{field:"cost",header:"Cost",style:{width:"30%"}},{body:u(n=>[A(H(m(G)(n.data.cost)),1)]),_:1}),a(d,{header:"Desactivada",style:{width:"10%"}},{body:u(n=>[a(W,{value:n.data.disabled},null,8,["value"])]),_:1}),a(d,null,{body:u(n=>[l("i",{class:J([m(p).TIMES,"grid_delete_column_button"]),onClick:F=>N(F,n.data)},null,10,se)]),_:1})]),_:1},8,["value"])}}});export{ce as default};
