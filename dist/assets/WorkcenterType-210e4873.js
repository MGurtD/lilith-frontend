import{d as w,o as C,j as E,C as B,r as g,h as T,k as a,c as W,e as d,i as u,n as V,z as k,l as x,a as F,s as N,F as m,v as h,u as q,m as D,P,W as U}from"./index-3259d18c.js";import{c as R,a as _,F as S}from"./form-validator-74a9b5a3.js";import{u as I}from"./plantmodel-b960b490.js";import"./index-1f526e6a.js";const $={key:0},A={class:"four-columns"},z=d("label",{class:"block text-900 mb-2"},"Desactivat",-1),L={class:"mt-2"},j=w({__name:"FormWorkcenterType",props:{workcentertype:{}},emits:["submit","cancel"],setup(v,{emit:i}){const c=v;C(async()=>{await r.fetchWorkcenterTypes()});const p=E(),r=I(),{workcenterType:e}=B(r),f=R().shape({name:_().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:_().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")}),n=g({result:!1,errors:{}}),y=()=>{const o=new S(f);n.value=o.validate(c.workcentertype)},s=async()=>{if(y(),n.value.result)i("submit",c.workcentertype);else{let o="";Object.entries(n.value.errors).forEach(t=>{o+=`${t[1].map(b=>b)}.   `}),p.add({severity:"warn",summary:"Formulari inválid",detail:o,life:5e3})}};return(o,t)=>{const b=T("Checkbox"),M=T("Button");return a(e)?(F(),W("form",$,[d("section",A,[u(k,{class:V(["mb-2",{"p-invalid":n.value.errors.name}]),label:"Nom",id:"name",modelValue:a(e).name,"onUpdate:modelValue":t[0]||(t[0]=l=>a(e).name=l)},null,8,["modelValue","class"]),u(k,{class:V(["mb-2",{"p-invalid":n.value.errors.description}]),label:"Descripció",id:"description",modelValue:a(e).description,"onUpdate:modelValue":t[1]||(t[1]=l=>a(e).description=l)},null,8,["modelValue","class"]),u(k,{type:a(N).NUMERIC,minFractionDigits:2,class:"mb-2",label:"Marge de benefici",id:"profitPercentage",modelValue:a(e).profitPercentage,"onUpdate:modelValue":t[2]||(t[2]=l=>a(e).profitPercentage=l),suffix:"%"},null,8,["type","modelValue"]),d("div",null,[z,u(b,{modelValue:a(e).disabled,"onUpdate:modelValue":t[3]||(t[3]=l=>a(e).disabled=l),class:"w-full",binary:!0},null,8,["modelValue"])])]),d("div",L,[u(M,{label:"Guardar",class:"mr-2",onClick:s})])])):x("",!0)}}}),K=w({__name:"WorkcenterType",setup(v){const i=g(m.EDIT),c=h(),p=q(),r=I(),{workcenterType:e}=B(r),f=async()=>{await r.fetchWorkcenterType(c.params.id);let s="";e.value?(i.value=m.EDIT,s=`Tipus de màquina: ${e.value.name}`):(i.value=m.CREATE,r.setNewWorkcenterType(c.params.id),s="Alta de tipus de màquina"),p.setMenuItem({icon:P.BUILDING,backButtonVisible:!0,title:s})};C(async()=>{await f()});const n=E(),y=async()=>{const s=e.value;let o=!1,t="";i.value===m.CREATE?(o=await r.createWorkcenterType(s),t="Tipus de màquina creat correctament"):(o=await r.updateWorkcenterType(s.id,s),t="Tipus de màquina actualizat correctament"),o&&(n.add({severity:"success",summary:t,life:5e3}),U.back())};return(s,o)=>a(e)?(F(),D(j,{key:0,workcentertype:a(e),onSubmit:y},null,8,["workcentertype"])):x("",!0)}});export{K as default};
