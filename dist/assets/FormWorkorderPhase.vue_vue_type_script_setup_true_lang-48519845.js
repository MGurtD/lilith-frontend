import{_ as W}from"./DropdownLifecycle.vue_vue_type_script_setup_true_lang-02070ccb.js";import{c as E,a as b,F as U}from"./form-validator-f8953ae6.js";import{d as B,j as g,H as F,r as q,h as u,c as L,e as l,i as r,y as m,n,k as c,l as N,a as $,s as D}from"./index-1f9e3570.js";import{u as M}from"./plantmodel-e3ef9a45.js";const _={key:0},j=l("br",null,null,-1),z={class:"three-columns mb-2"},P={class:"three-columns mb-2"},R=l("label",{class:"block text-900 mb-2"},"Tipus de màquina",-1),S=l("label",{class:"block text-900 mb-2"},"Màquina preferida",-1),G=l("label",{class:"block text-900 mb-2"},"Tipus d'operari",-1),H={class:"three-columns mb-2"},O=l("label",{class:"block text-900 mt-1 mb-1"},"Externa",-1),K=B({__name:"FormWorkorderPhase",props:{workorder:{},phase:{}},emits:["submit","cancel"],setup(h,{emit:k}){const a=h,V=g(),d=M(),f=F(()=>a.phase.workcenterTypeId?d.getWorkcentersByTypeId(a.phase.workcenterTypeId):[]),v=()=>{a.phase.preferredWorkcenterId=null},y=()=>{a.phase.isExternalWork&&(a.phase.operatorTypeId=null,a.phase.workcenterTypeId=null,a.phase.preferredWorkcenterId=null)},I=E().shape({code:b().required("El codi és obligatori"),statusId:b().required("L'estat és obligatori")}),t=q({result:!1,errors:{}}),w=()=>{const e=new U(I);t.value=e.validate(a.phase)},T=async()=>{if(w(),t.value.result)a.phase.preferredWorkcenterId===""&&(a.phase.preferredWorkcenterId=null),k("submit",a.phase);else{let e="";Object.entries(t.value.errors).forEach(o=>{e+=`${o[1].map(p=>p)}.   `}),V.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,o)=>{const p=u("Button"),i=u("Dropdown"),C=u("Checkbox");return e.phase?($(),L("form",_,[l("div",null,[r(p,{label:"Guardar Fase",class:"grid_add_row_button",size:"small",onClick:T}),j]),l("section",z,[l("div",null,[r(m,{label:"Codi de la fase",modelValue:e.phase.code,"onUpdate:modelValue":o[0]||(o[0]=s=>e.phase.code=s)},null,8,["modelValue"])]),l("div",null,[r(m,{label:"Descripció",modelValue:e.phase.description,"onUpdate:modelValue":o[1]||(o[1]=s=>e.phase.description=s)},null,8,["modelValue"])]),l("div",null,[r(W,{label:"Estat",modelValue:e.phase.statusId,"onUpdate:modelValue":o[2]||(o[2]=s=>e.phase.statusId=s),class:n({"p-invalid":t.value.errors.statusId})},null,8,["modelValue","class"])])]),l("section",P,[l("div",null,[R,r(i,{modelValue:e.phase.workcenterTypeId,"onUpdate:modelValue":o[3]||(o[3]=s=>e.phase.workcenterTypeId=s),editable:"",options:c(d).workcenterTypes,optionValue:"id",optionLabel:"name",class:n(["w-full",{"p-invalid":t.value.errors.workcenterTypeId}]),onChange:v},null,8,["modelValue","options","class"])]),l("div",null,[S,r(i,{modelValue:e.phase.preferredWorkcenterId,"onUpdate:modelValue":o[4]||(o[4]=s=>e.phase.preferredWorkcenterId=s),editable:"",options:f.value,optionValue:"id",optionLabel:"description",class:"w-full"},null,8,["modelValue","options"])]),l("div",null,[G,r(i,{modelValue:e.phase.operatorTypeId,"onUpdate:modelValue":o[5]||(o[5]=s=>e.phase.operatorTypeId=s),editable:"",options:c(d).operatorTypes,optionValue:"id",optionLabel:"description",class:n(["w-full",{"p-invalid":t.value.errors.operatorTypeId}])},null,8,["modelValue","options","class"])])]),l("section",H,[l("div",null,[O,r(C,{modelValue:e.phase.isExternalWork,"onUpdate:modelValue":o[6]||(o[6]=s=>e.phase.isExternalWork=s),class:"w-full",binary:!0,onChange:y},null,8,["modelValue"])]),l("div",null,[r(m,{type:c(D).CURRENCY,label:"Cost extern",modelValue:e.phase.externalWorkCost,"onUpdate:modelValue":o[7]||(o[7]=s=>e.phase.externalWorkCost=s),disabled:!e.phase.isExternalWork,class:n({"p-invalid":t.value.errors.externalWorkCost})},null,8,["type","modelValue","disabled","class"])])])])):N("",!0)}}});export{K as _};
