import{d as I,h as u,c as _,e as r,i as t,k as d,z as y,L as U,a as m,s as k,o as w,j as F,r as N,m as g,l as $}from"./index-948abaa8.js";import{_ as L,a as T}from"./DropdownReferenceType.vue_vue_type_script_setup_true_lang-81f6ea9c.js";import{u as h}from"./tax-635ce292.js";import{u as A}from"./reference-1627cbd8.js";import{R as b}from"./index-7cbe1881.js";import{a as V,c as E,d as R,F as S}from"./form-validator-ae6c613c.js";const D={class:"three-columns"},B={class:"mt-1"},q={class:"mt-1"},M=r("label",{class:"block text-900 mb-2"},"Format",-1),O={class:"mt-1"},Y=r("label",{class:"block text-900 mb-2"},"Impost",-1),j={class:"three-columns"},z={class:"mt-1"},P=r("label",{class:"block text-900 mb-2"},"Desactivada",-1),G=I({__name:"FormReferenceMaterial",props:{reference:{}},setup(v){const c=h(),a=A();return(e,o)=>{const n=u("Dropdown"),p=u("Checkbox");return m(),_(U,null,[r("section",D,[r("div",B,[t(L,{label:"Tipus de material",modelValue:e.reference.referenceTypeId,"onUpdate:modelValue":o[0]||(o[0]=l=>e.reference.referenceTypeId=l)},null,8,["modelValue"])]),r("div",q,[M,t(n,{modelValue:e.reference.referenceFormatId,"onUpdate:modelValue":o[1]||(o[1]=l=>e.reference.referenceFormatId=l),editable:"",options:d(a).referenceFormats,optionValue:"id",optionLabel:"description",class:"w-full"},null,8,["modelValue","options"])]),r("div",O,[Y,t(n,{modelValue:e.reference.taxId,"onUpdate:modelValue":o[2]||(o[2]=l=>e.reference.taxId=l),editable:"",options:d(c).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",j,[r("div",z,[t(y,{type:d(k).CURRENCY,label:"Últim cost",id:"lastCost",modelValue:e.reference.lastCost,"onUpdate:modelValue":o[3]||(o[3]=l=>e.reference.lastCost=l),disabled:""},null,8,["type","modelValue"])]),r("div",null,[P,t(p,{modelValue:e.reference.disabled,"onUpdate:modelValue":o[4]||(o[4]=l=>e.reference.disabled=l),binary:!0},null,8,["modelValue"])])])],64)}}}),x={class:"three-columns"},H={class:"mt-1"},J=r("label",{class:"block text-900 mb-2"},"Impost",-1),K=I({__name:"FormReferenceTool",props:{reference:{}},setup(v){const c=h();return w(async()=>{c.taxes||await c.fetchAll()}),(a,e)=>{const o=u("Dropdown");return m(),_("section",x,[r("div",H,[J,t(o,{modelValue:a.reference.taxId,"onUpdate:modelValue":e[0]||(e[0]=n=>a.reference.taxId=n),editable:"",options:d(c).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])])}}}),Q={class:"four-columns"},W={class:"mt-1"},X={class:"mt-1"},Z={class:"mt-1"},ee=r("label",{class:"block text-900 mb-2"},"Impost",-1),oe=r("label",{class:"block text-900 mb-2"},"Desactivada",-1),re=I({__name:"FormReferenceService",props:{reference:{}},emits:["submit","cancel"],setup(v,{emit:c}){const a=h();return w(async()=>{a.taxes||await a.fetchAll()}),(e,o)=>{const n=u("Dropdown"),p=u("Checkbox");return m(),_("section",Q,[r("div",W,[t(y,{type:d(k).CURRENCY,label:"Preu servei",modelValue:e.reference.price,"onUpdate:modelValue":o[0]||(o[0]=l=>e.reference.price=l)},null,8,["type","modelValue"])]),r("div",X,[t(y,{type:d(k).CURRENCY,label:"Preu transport",modelValue:e.reference.transportAmount,"onUpdate:modelValue":o[1]||(o[1]=l=>e.reference.transportAmount=l)},null,8,["type","modelValue"])]),r("div",Z,[ee,t(n,{modelValue:e.reference.taxId,"onUpdate:modelValue":o[2]||(o[2]=l=>e.reference.taxId=l),editable:"",options:d(a).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),r("div",null,[oe,t(p,{modelValue:e.reference.disabled,"onUpdate:modelValue":o[3]||(o[3]=l=>e.reference.disabled=l),binary:!0},null,8,["modelValue"])])])}}}),se=r("br",null,null,-1),le={key:0},te={class:"three-columns"},ae={class:"mt-1"},ne={class:"mt-1"},ie={class:"mt-1"},be=I({__name:"FormMaterial",props:{reference:{}},emits:["submit"],setup(v,{emit:c}){const a=v,e=F(),o={code:V().required("El codi és obligatoria").max(50,"El codi no pot superar els 50 carácters"),description:V().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")},n=N({result:!1,errors:{}}),p=()=>{let s={};a.reference.categoryName===b.MATERIAL?s=E().shape({...o,taxId:V().required("L'IVA és obligatori"),referenceTypeId:V().required("El tipus de referència és obligatori"),referenceFormatId:V().required("El format és obligatori")}):a.reference.categoryName===b.SERVICE&&(s=E().shape({...o,price:R().required("El preu és obligatori"),transportAmount:R().required("El preu de transport és obligatori")}));const i=new S(s);n.value=i.validate(a.reference)},l=async()=>{if(p(),n.value.result)c("submit",a.reference);else{let s="";Object.entries(n.value.errors).forEach(i=>{s+=`${i[1].map(C=>C)}.   `}),e.add({severity:"warn",summary:"Formulari inválid",detail:s,life:5e3})}};return(s,i)=>{const C=u("Button");return m(),_(U,null,[r("div",null,[t(C,{label:"Guardar",class:"grid_add_row_button",size:"small",onClick:l}),se]),s.reference?(m(),_("form",le,[r("section",te,[r("div",ae,[t(y,{class:"mb-2",label:"Codi",id:"code",modelValue:s.reference.code,"onUpdate:modelValue":i[0]||(i[0]=f=>s.reference.code=f)},null,8,["modelValue"])]),r("div",ne,[t(y,{class:"mb-2",label:"Descripció",id:"description",modelValue:s.reference.description,"onUpdate:modelValue":i[1]||(i[1]=f=>s.reference.description=f)},null,8,["modelValue"])]),r("div",ie,[t(T,{label:"Categoria",modelValue:s.reference.categoryName,"onUpdate:modelValue":i[2]||(i[2]=f=>s.reference.categoryName=f),disabled:""},null,8,["modelValue"])])]),s.reference.categoryName===d(b).MATERIAL?(m(),g(G,{key:0,reference:s.reference},null,8,["reference"])):$("",!0),s.reference.categoryName===d(b).TOOL?(m(),g(K,{key:1,reference:s.reference},null,8,["reference"])):$("",!0),s.reference.categoryName===d(b).SERVICE?(m(),g(re,{key:2,reference:s.reference},null,8,["reference"])):$("",!0)])):$("",!0)],64)}}});export{be as _};
