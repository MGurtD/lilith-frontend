import{u as x}from"./customers-cddcd1f1.js";import{d as C,j as h,E as w,o as I,r as k,h as c,a as E,c as S,e as s,i,k as d,D as g}from"./index-aa781fed.js";import{c as D,a as u,e as B,F}from"./form-validator-ef8c3cb9.js";const y={class:"mt-2"},L=s("label",{class:"block text-900 mb-2"},"Client",-1),N={class:"mt-2"},O=s("label",{class:"block text-900 mb-2"},"Exercici",-1),$={class:"mt-2"},T=s("label",{class:"block text-900 mb-2"},"Data",-1),U={class:"mt-2"},M=C({__name:"FormCreateOrderOrInvoice",props:{createRequest:{}},emits:["submit"],setup(m,{emit:p}){const a=m,b=h(),l=w(),f=x();I(async()=>{var t;l.exercises||await l.fetchActive();var e=(t=l.exercises)==null?void 0:t.find(o=>o.name===new Date().getFullYear().toString());e&&(a.createRequest.exerciseId=e.id)});const v=D().shape({exerciseId:u().required("L'exercici és obligatori"),customerId:u().required("El client és obligatori"),date:B().required("La data és obligatòria")}),n=k({result:!1,errors:{}}),q=()=>{const e=new F(v);n.value=e.validate(a.createRequest)},V=()=>{if(q(),n.value.result)a.createRequest.date=g(a.createRequest.date),p("submit",a.createRequest);else{let e="";Object.entries(n.value.errors).forEach(t=>{e+=`${t[1].map(o=>o)}.   `}),b.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,t)=>{const o=c("Dropdown"),_=c("Calendar"),R=c("Button");return E(),S("form",null,[s("div",y,[L,i(o,{class:"w-full",modelValue:e.createRequest.customerId,"onUpdate:modelValue":t[0]||(t[0]=r=>e.createRequest.customerId=r),editable:"",options:d(f).customers,optionValue:"id",optionLabel:"comercialName"},null,8,["modelValue","options"])]),s("div",N,[O,i(o,{class:"w-full",modelValue:e.createRequest.exerciseId,"onUpdate:modelValue":t[1]||(t[1]=r=>e.createRequest.exerciseId=r),editable:"",options:d(l).exercises,optionValue:"id",optionLabel:"name"},null,8,["modelValue","options"])]),s("div",$,[T,i(_,{modelValue:e.createRequest.date,"onUpdate:modelValue":t[2]||(t[2]=r=>e.createRequest.date=r)},null,8,["modelValue"])]),s("footer",U,[i(R,{label:"Crear",onClick:V,style:{float:"right"}})])])}}});export{M as _};
