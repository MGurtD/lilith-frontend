import{F as L}from"./FileEntityPicker-2790cebd.js";import{d as E,j as x,z as g,r as F,h as y,k as e,c as q,e as a,i as c,n as b,y as T,l as B,a as I,F as k,v as S,u as D,o as U,m as W,G as N,P as $,L as A}from"./index-d7d79c10.js";import{c as P,a as f,F as R}from"./form-validator-f8953ae6.js";import{u as C}from"./plantmodel-8210c603.js";import{u as z}from"./shift-cff3f7e0.js";import"./functions-e7c8fc70.js";import"./_commonjsHelpers-725317a4.js";import"./v4-a960c1f4.js";import"./index-eb566870.js";import"./base.service-fd6835a1.js";const G={key:0},j={class:"grid_add_row_button"},O={class:"three-columns mb-2"},H=a("label",{class:"block text-900 mb-2"},"Desactivat",-1),J={class:"three-columns"},K=a("label",{class:"block text-900 mb-2"},"Tipus",-1),Q=a("label",{class:"block text-900 mb-2"},"Area",-1),X=a("label",{class:"block text-900 mb-2"},"Torn",-1),Y=E({__name:"FormWorkcenter",props:{workcenter:{}},emits:["submit","cancel"],setup(h,{emit:p}){const u=h,v=x(),n=C(),d=z(),{workcenter:o}=g(n),_=P().shape({name:f().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:f().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),workcenterTypeId:f().required("El tipus es obligatori"),areaId:f().required("L'area es obligatoria"),shiftId:f().required("El torn es obligatori")}),l=F({result:!1,errors:{}}),r=()=>{const i=new R(_);l.value=i.validate(u.workcenter)},m=async()=>{if(r(),l.value.result)p("submit",u.workcenter);else{let i="";Object.entries(l.value.errors).forEach(t=>{i+=`${t[1].map(V=>V)}.   `}),v.add({severity:"warn",summary:"Formulari inválid",detail:i,life:5e3})}};return(i,t)=>{const V=y("Button"),M=y("Checkbox"),w=y("Dropdown");return e(o)?(I(),q("form",G,[a("div",j,[c(V,{label:"Guardar",style:{float:"right"},onClick:m})]),a("section",O,[c(T,{label:"Nom",id:"name",modelValue:e(o).name,"onUpdate:modelValue":t[0]||(t[0]=s=>e(o).name=s),class:b({"p-invalid":l.value.errors.name})},null,8,["modelValue","class"]),c(T,{label:"Descripció",id:"description",modelValue:e(o).description,"onUpdate:modelValue":t[1]||(t[1]=s=>e(o).description=s),class:b({"p-invalid":l.value.errors.description})},null,8,["modelValue","class"]),a("div",null,[H,c(M,{modelValue:e(o).disabled,"onUpdate:modelValue":t[2]||(t[2]=s=>e(o).disabled=s),class:"w-full",binary:!0},null,8,["modelValue"])])]),a("section",J,[a("div",null,[K,c(w,{modelValue:e(o).workcenterTypeId,"onUpdate:modelValue":t[3]||(t[3]=s=>e(o).workcenterTypeId=s),editable:"",options:e(n).workcenterTypes,optionValue:"id",optionLabel:"name",class:b(["w-full",{"p-invalid":l.value.errors.workcenterTypeId}])},null,8,["modelValue","options","class"])]),a("div",null,[Q,c(w,{modelValue:e(o).areaId,"onUpdate:modelValue":t[4]||(t[4]=s=>e(o).areaId=s),editable:"",options:e(n).areas,optionValue:"id",optionLabel:"name",class:b(["w-full",{"p-invalid":l.value.errors.areaId}])},null,8,["modelValue","options","class"])]),a("div",null,[X,c(w,{modelValue:e(o).shiftId,"onUpdate:modelValue":t[5]||(t[5]=s=>e(o).shiftId=s),editable:"",options:e(d).shifts,optionValue:"id",optionLabel:"name",class:b(["w-full",{"p-invalid":l.value.errors.shiftId}])},null,8,["modelValue","options","class"])])])])):B("",!0)}}}),Z={class:"mt-4"},de=E({__name:"Workcenter",setup(h){const p=F(k.EDIT),u=S(),v=D(),n=C(),{workcenter:d}=g(n),o=async()=>{await n.fetchWorkcenter(u.params.id);let r="";d.value?(p.value=k.EDIT,r=`Màquina: ${d.value.name}`):(p.value=k.CREATE,n.setNewWorkcenter(u.params.id),r="Alta de màquina"),v.setMenuItem({icon:$.BUILDING,backButtonVisible:!0,title:r})};U(async()=>{await o()});const _=x(),l=async()=>{const r=d.value;let m=!1,i="";p.value===k.CREATE?(m=await n.createWorkcenter(r),i="Màquina creada correctament"):(m=await n.updateWorkcenter(r.id,r),i="Màquina actualizada correctament"),m&&(_.add({severity:"success",summary:i,life:5e3}),A.back())};return(r,m)=>(I(),q(N,null,[e(d)?(I(),W(Y,{key:0,workcenter:e(d),onSubmit:l},null,8,["workcenter"])):B("",!0),a("section",Z,[c(L,{title:"Imatge de la màquina",entity:"WorkcenterPicture","max-files":1,id:e(u).params.id},null,8,["id"])])],64))}});export{de as default};
