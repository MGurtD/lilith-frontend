import{d as y,o as C,j as E,C as x,r as M,h as _,k as l,c as T,e as o,i as r,n as k,z as S,l as U,a as B,F as p,v as g,u as q,m as A,P as N,V as P}from"./index-206100ee.js";import{c as D,a as h,F as $}from"./form-validator-5b9c5f96.js";import{u as F}from"./plantmodel-2b896d62.js";import"./index-7fb928b0.js";const R={key:0},z={class:"grid_add_row_button"},L={class:"four-columns pt-4"},j=o("label",{class:"block text-900 mb-2"},"Color",-1),G={class:"five-columns"},O=o("label",{class:"block text-900 mb-2"},"Aturada",-1),H=o("label",{class:"block text-900 mb-2"},"Operaris",-1),J=o("label",{class:"block text-900 mb-2"},"Tancada",-1),K=o("label",{class:"block text-900 mb-2"},"Preferida",-1),Q=o("label",{class:"block text-900 mb-2"},"Desactivat",-1),W=y({__name:"FormMachineStatus",props:{machineStatus:{}},emits:["submit","cancel"],setup(w,{emit:c}){const d=w;C(async()=>{await i.fetchMachineStatuses()});const b=E(),i=F(),{machineStatus:e}=x(i),f=D().shape({name:h().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:h().required("La descripció és obligatoria").max(250,"La descripció pot superar els 250 carácters"),color:h().required("El color es obligatori")}),u=M({result:!1,errors:{}}),V=()=>{const n=new $(f);u.value=n.validate(d.machineStatus)},s=async()=>{if(V(),u.value.result)c("submit",d.machineStatus);else{let n="";Object.entries(u.value.errors).forEach(a=>{n+=`${a[1].map(v=>v)}.   `}),b.add({severity:"warn",summary:"Formulari inválid",detail:n,life:5e3})}};return(n,a)=>{const v=_("Button"),I=_("ColorPicker"),m=_("Checkbox");return l(e)?(B(),T("form",R,[o("div",z,[r(v,{label:"Guardar",style:{float:"right"},onClick:s})]),o("section",L,[r(S,{class:k(["mb-2",{"p-invalid":u.value.errors.name}]),label:"Nom",id:"name",modelValue:l(e).name,"onUpdate:modelValue":a[0]||(a[0]=t=>l(e).name=t)},null,8,["modelValue","class"]),r(S,{class:k(["mb-2",{"p-invalid":u.value.errors.description}]),label:"Descripció",id:"description",modelValue:l(e).description,"onUpdate:modelValue":a[1]||(a[1]=t=>l(e).description=t)},null,8,["modelValue","class"]),o("div",null,[j,r(I,{modelValue:l(e).color,"onUpdate:modelValue":a[2]||(a[2]=t=>l(e).color=t),class:k(["mb-2",{"p-invalid":u.value.errors.color}]),label:"Color",id:"color"},null,8,["modelValue","class"])]),o("div",null,[r(S,{class:"mb-2",label:"Icona",id:"icon",modelValue:l(e).icon,"onUpdate:modelValue":a[3]||(a[3]=t=>l(e).icon=t)},null,8,["modelValue"])])]),o("section",G,[o("div",null,[O,r(m,{modelValue:l(e).stoped,"onUpdate:modelValue":a[4]||(a[4]=t=>l(e).stoped=t),class:"w-full",binary:!0},null,8,["modelValue"])]),o("div",null,[H,r(m,{modelValue:l(e).operatorsAllowed,"onUpdate:modelValue":a[5]||(a[5]=t=>l(e).operatorsAllowed=t),class:"w-full",binary:!0},null,8,["modelValue"])]),o("div",null,[J,r(m,{modelValue:l(e).closed,"onUpdate:modelValue":a[6]||(a[6]=t=>l(e).closed=t),class:"w-full",binary:!0},null,8,["modelValue"])]),o("div",null,[K,r(m,{modelValue:l(e).preferred,"onUpdate:modelValue":a[7]||(a[7]=t=>l(e).preferred=t),class:"w-full",binary:!0},null,8,["modelValue"])]),o("div",null,[Q,r(m,{modelValue:l(e).disabled,"onUpdate:modelValue":a[8]||(a[8]=t=>l(e).disabled=t),class:"w-full",binary:!0},null,8,["modelValue"])])])])):U("",!0)}}}),ae=y({__name:"MachineStatus",setup(w){const c=M(p.EDIT),d=g(),b=q(),i=F(),{machineStatus:e}=x(i),f=async()=>{await i.fetchMachineStatus(d.params.id);let s="";e.value?(c.value=p.EDIT,s=`Estat de màquina ${e.value.name}`):(c.value=p.CREATE,i.setNewMachineStatus(d.params.id),s="Alta d'estat de màquina"),b.setMenuItem({icon:N.BUILDING,backButtonVisible:!0,title:s})};C(async()=>{await f()});const u=E(),V=async()=>{const s=e.value;let n=!1,a="";c.value===p.CREATE?(n=await i.createMachineStatus(s),a="Estat de màquina creat correctament"):(n=await i.updateMachineStatus(s.id,s),a="Estat de màquina actualizat correctament"),n&&(u.add({severity:"success",summary:a,life:5e3}),P.back())};return(s,n)=>l(e)?(B(),A(W,{key:0,machineStatus:l(e),onSubmit:V},null,8,["machineStatus"])):U("",!0)}});export{ae as default};
