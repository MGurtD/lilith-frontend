import{d as L,r as N,j as P,x as A,g as M,u as R,R as j,o as F,P as d,h as i,c as U,i as e,k as u,w as o,L as G,y as S,a as z,e as c,n as h,H as K,p as J,b as O,f as Q}from"./index-0165ef2a.js";import{u as W}from"./customers-7ea2bdbb.js";const y=m=>(J("data-v-af8a94b0"),m=m(),O(),m),X=y(()=>c("span",null,"Clients",-1)),Y={class:"references-header"},Z={class:"references-filter"},ee=y(()=>c("label",null,"Nom comercial",-1)),te=["onClick"],se=y(()=>c("span",null,"Tipus de client",-1)),ae=["onClick"],oe=L({__name:"Customers",setup(m){const f=N(0),b=P(),g=A(),p=M(),k=R(),l=W(),_=N({code:""}),x=j(()=>l.customers?_.value.code.length>0?l.customers.filter(t=>t.comercialName.toLowerCase().includes(_.value.code.toLowerCase())):l.customers:[]);F(async()=>{await l.fetchCustomers(),await l.fetchCustomerTypes(),k.setMenuItem({title:"Clients",icon:d.HASHTAG})});const B=t=>{var r;const s=(r=l.customerTypes)==null?void 0:r.find(v=>v.id===t);if(s)return s.name},E=(t,s)=>{g.require({target:t.currentTarget,message:`Está segur que vol eliminar el client ${s.comercialName}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await l.deleteCustomer(s.id)&&(b.add({severity:"success",summary:"Eliminat",life:3e3}),await l.fetchCustomers())}})},D=(t,s)=>{g.require({target:t.currentTarget,message:`Está segur que vol eliminar el tipus de client ${s.name}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await l.deleteCustomerType(s.id)&&(b.add({severity:"success",summary:"Eliminat",life:3e3}),await l.fetchCustomerTypes())}})},H=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||p.push({path:`/customers/${t.data.id}`})},V=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||p.push({path:`/customer-types/${t.data.id}`})},q=()=>{f.value===0?p.push({path:`/customers/${S()}`}):p.push({path:`/customer-types/${S()}`})};return(t,s)=>{const r=i("Button"),v=i("BaseInput"),n=i("Column"),w=i("BooleanColumn"),T=i("DataTable"),I=i("TabPanel"),$=i("TabView");return z(),U(G,null,[e(r,{icon:u(d).PLUS,class:"grid_add_row_button",rounded:"",onClick:q},null,8,["icon"]),e($,{activeIndex:f.value,"onUpdate:activeIndex":s[1]||(s[1]=a=>f.value=a)},{default:o(()=>[e(I,null,{header:o(()=>[c("i",{class:h([u(d).LINK,"mr-2"])},null,2),X]),default:o(()=>[e(T,{value:x.value,tableStyle:"min-width: 100%","sort-field":"comercialName","sort-order":1,scrollable:"",scrollHeight:"80vh",onRowClick:H},{header:o(()=>[c("div",Y,[c("div",Z,[ee,e(v,{modelValue:_.value.code,"onUpdate:modelValue":s[0]||(s[0]=a=>_.value.code=a)},null,8,["modelValue"])])])]),default:o(()=>[e(n,{field:"comercialName",header:"Nom comercial",sortable:"",style:{width:"20%"}}),e(n,{field:"taxName",header:"Nom Fiscal",style:{width:"20%"}}),e(n,{field:"vatNumber",header:"CIF",style:{width:"20%"}}),e(n,{header:"Tipus",style:{width:"20%"}},{body:o(a=>[c("span",null,K(B(a.data.customerTypeId)),1)]),_:1}),e(n,{header:"Desactivat",sortable:"",style:{width:"20%"}},{body:o(a=>[e(w,{value:a.data.disabled,showColor:!1},null,8,["value"])]),_:1}),e(n,null,{body:o(a=>[c("i",{class:h([u(d).TIMES,"grid_delete_column_button"]),onClick:C=>E(C,a.data)},null,10,te)]),_:1})]),_:1},8,["value"])]),_:1}),e(I,null,{header:o(()=>[c("i",{class:h([u(d).HASHTAG,"mr-2"])},null,2),se]),default:o(()=>[e(T,{value:u(l).customerTypes,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",onRowClick:V},{default:o(()=>[e(n,{field:"name",header:"Nom",style:{width:"33%"}}),e(n,{field:"description",header:"Descripció",style:{width:"33%"}}),e(n,{header:"Desactivat",style:{width:"33%"}},{body:o(a=>[e(w,{value:a.data.disabled},null,8,["value"])]),_:1}),e(n,null,{body:o(a=>[c("i",{class:h([u(d).TIMES,"grid_delete_column_button"]),onClick:C=>D(C,a.data)},null,10,ae)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["activeIndex"])],64)}}});const ce=Q(oe,[["__scopeId","data-v-af8a94b0"]]);export{ce as default};
