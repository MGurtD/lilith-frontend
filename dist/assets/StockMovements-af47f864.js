import{_ as b}from"./ExerciseDatePicker.vue_vue_type_script_setup_true_lang-bd121bc6.js";import{d as g,j as P,u as T,r as M,o as C,P as m,h as f,c as F,i as e,w as n,k as a,a as B,e as c,C as _,D as x}from"./index-1f9e3570.js";import{u as I}from"./stockMovement-74752093.js";import{u as E}from"./reference-79c88333.js";import{u as R}from"./exercise-073c5bf0.js";import{h as A,a as y}from"./functions-2e154ea4.js";import"./index-c5453002.js";import"./base.service-e02629e7.js";import"./reference.service-859533eb.js";import"./index-a13a1f31.js";import"./_commonjsHelpers-725317a4.js";import"./v4-a960c1f4.js";const L={class:"flex flex-wrap align-items-center justify-content-between gap-2"},N={class:"datatable-filter"},V={class:"filter-field"},j={class:"datatable-buttons"},z="temges.stockMovements.filter",ee=g({__name:"StockMovements",setup(G){const v=P(),s=T(),u=I(),h=E(),l=R(),w=M({exercise:void 0});C(async()=>{s.setMenuItem({icon:m.MAP,title:"Moviments de magatzem"}),await l.fetchAll(),await h.fetchReferences(),k()});const k=()=>{var r;const o=new Date().getFullYear().toString(),i=(r=l.exercises)==null?void 0:r.find(t=>t.name===o);i&&(s.exercisePicker.exercise=i,s.exercisePicker.dates=[new Date(s.exercisePicker.exercise.startDate),new Date(s.exercisePicker.exercise.endDate)])},S=()=>{s.cleanExercisePicker()},p=async()=>{if(s.exercisePicker.dates){const o=y(s.exercisePicker.dates[0]),i=y(s.exercisePicker.dates[1]);await u.GetBetweenDates(o,i),localStorage.setItem(z,JSON.stringify(w.value))}else v.add({severity:"info",summary:"Filtre invàlid",detail:"Seleccioni un període",life:5e3})};return(o,i)=>{const r=f("Button"),t=f("Column"),D=f("DataTable");return B(),F("div",null,[e(D,{class:"p-datatable-sm",tableStyle:"min-width:100%",scrollable:"",scrollHeight:"80vh",sortField:"movementDate",sortOrder:1,value:a(u).stockMovements},{header:n(()=>[c("div",L,[c("div",N,[c("div",V,[e(b,{exercises:a(l).exercises,onRangeSelected:p},null,8,["exercises"])])]),c("div",j,[e(r,{class:"datatable-button mr-2",icon:a(m).FILTER,rounded:"",raised:"",onClick:p},null,8,["icon"]),e(r,{class:"datatable-button mr-2",icon:a(m).FILTER_SLASH,rounded:"",raised:"",onClick:S},null,8,["icon"])])])]),default:n(()=>[e(t,{header:"Data",field:"movementDate",sortable:"",style:{width:"15%"}},{body:n(d=>[_(x(a(A)(d.data.movementDate)),1)]),_:1}),e(t,{header:"Referència",style:{width:"20%"}},{body:n(d=>[_(x(a(h).getFullNameById(d.data.referenceId)),1)]),_:1}),e(t,{field:"width",header:"Ample (x) mm",style:{width:"5%"}}),e(t,{field:"length",header:"Llarg (y) mm",style:{width:"5%"}}),e(t,{field:"height",header:"Alt (z) mm",style:{width:"5%"}}),e(t,{field:"diameter",header:"Diámetre mm",style:{width:"5%"}}),e(t,{field:"thickness",header:"Gruix mm",style:{width:"5%"}}),e(t,{field:"description",header:"Descripció",style:{width:"25%"}}),e(t,{field:"movementType",header:"Tipus de moviment",style:{width:"10%"}}),e(t,{field:"quantity",header:"Quantitat",style:{width:"10%"}})]),_:1},8,["value"])])}}});export{ee as default};
