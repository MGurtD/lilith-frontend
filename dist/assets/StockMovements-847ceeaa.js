import{_ as b}from"./ExerciseDatePicker.vue_vue_type_script_setup_true_lang-b78d4484.js";import{d as g,j as P,u as T,E as M,r as C,o as F,P as m,h as f,c as B,i as e,w as n,k as a,a as E,e as c,G as x,H as y,aj as I,O as p}from"./index-3259d18c.js";import{u as R}from"./stockMovement-a8fe8d85.js";import{u as A}from"./reference-1e4fc38c.js";import"./index-c2df7f53.js";const L={class:"flex flex-wrap align-items-center justify-content-between gap-2"},N={class:"datatable-filter"},j={class:"filter-field"},G={class:"datatable-buttons"},H="temges.stockMovements.filter",J=g({__name:"StockMovements",setup(O){const v=P(),s=T(),u=R(),h=A(),l=M(),w=C({exercise:void 0});F(async()=>{s.setMenuItem({icon:m.MAP,title:"Moviments de magatzem"}),await l.fetchAll(),await h.fetchReferences(),k()});const k=()=>{var r;const o=new Date().getFullYear().toString(),i=(r=l.exercises)==null?void 0:r.find(t=>t.name===o);i&&(s.exercisePicker.exercise=i,s.exercisePicker.dates=[new Date(s.exercisePicker.exercise.startDate),new Date(s.exercisePicker.exercise.endDate)])},S=()=>{s.cleanExercisePicker()},_=async()=>{if(s.exercisePicker.dates){const o=p(s.exercisePicker.dates[0]),i=p(s.exercisePicker.dates[1]);await u.GetBetweenDates(o,i),localStorage.setItem(H,JSON.stringify(w.value))}else v.add({severity:"info",summary:"Filtre invàlid",detail:"Seleccioni un període",life:5e3})};return(o,i)=>{const r=f("Button"),t=f("Column"),D=f("DataTable");return E(),B("div",null,[e(D,{class:"p-datatable-sm",tableStyle:"min-width:100%",scrollable:"",scrollHeight:"80vh",sortField:"movementDate",sortOrder:1,value:a(u).stockMovements},{header:n(()=>[c("div",L,[c("div",N,[c("div",j,[e(b,{exercises:a(l).exercises,onRangeSelected:_},null,8,["exercises"])])]),c("div",G,[e(r,{class:"datatable-button mr-2",icon:a(m).FILTER,rounded:"",raised:"",onClick:_},null,8,["icon"]),e(r,{class:"datatable-button mr-2",icon:a(m).FILTER_SLASH,rounded:"",raised:"",onClick:S},null,8,["icon"])])])]),default:n(()=>[e(t,{header:"Data",field:"movementDate",sortable:"",style:{width:"15%"}},{body:n(d=>[x(y(a(I)(d.data.movementDate)),1)]),_:1}),e(t,{header:"Referència",style:{width:"20%"}},{body:n(d=>[x(y(a(h).getFullNameById(d.data.referenceId)),1)]),_:1}),e(t,{field:"width",header:"Ample (x) mm",style:{width:"5%"}}),e(t,{field:"length",header:"Llarg (y) mm",style:{width:"5%"}}),e(t,{field:"height",header:"Alt (z) mm",style:{width:"5%"}}),e(t,{field:"diameter",header:"Diámetre mm",style:{width:"5%"}}),e(t,{field:"thickness",header:"Gruix mm",style:{width:"5%"}}),e(t,{field:"description",header:"Descripció",style:{width:"25%"}}),e(t,{field:"movementType",header:"Tipus de moviment",style:{width:"10%"}}),e(t,{field:"quantity",header:"Quantitat",style:{width:"10%"}})]),_:1},8,["value"])])}}});export{J as default};
