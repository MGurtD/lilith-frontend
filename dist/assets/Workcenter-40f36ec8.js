import{d as T,j as E,z as x,r as g,h as I,k as e,c as F,e as s,i as d,n as b,y as h,l as q,a as B,F as k,v as L,u as S,o as D,m as U,P as N,L as W}from"./index-0c51ec9c.js";import{c as A,a as f,F as $}from"./form-validator-f8953ae6.js";import{u as C}from"./plantmodel-f7819718.js";import{u as R}from"./shift-410d55e1.js";import"./_commonjsHelpers-725317a4.js";import"./index-3b48b213.js";import"./base.service-ebedc193.js";const z={key:0},P={class:"grid_add_row_button"},j={class:"three-columns mb-2"},G=s("label",{class:"block text-900 mb-2"},"Desactivat",-1),O={class:"three-columns"},H=s("label",{class:"block text-900 mb-2"},"Tipus",-1),J=s("label",{class:"block text-900 mb-2"},"Area",-1),K=s("label",{class:"block text-900 mb-2"},"Torn",-1),Q=T({__name:"FormWorkcenter",props:{workcenter:{}},emits:["submit","cancel"],setup(y,{emit:m}){const p=y,v=E(),n=C(),c=R(),{workcenter:o}=x(n),V=A().shape({name:f().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:f().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),workcenterTypeId:f().required("El tipus es obligatori"),areaId:f().required("L'area es obligatoria"),shiftId:f().required("El torn es obligatori")}),l=g({result:!1,errors:{}}),r=()=>{const i=new $(V);l.value=i.validate(p.workcenter)},u=async()=>{if(r(),l.value.result)m("submit",p.workcenter);else{let i="";Object.entries(l.value.errors).forEach(t=>{i+=`${t[1].map(w=>w)}.   `}),v.add({severity:"warn",summary:"Formulari inválid",detail:i,life:5e3})}};return(i,t)=>{const w=I("Button"),M=I("Checkbox"),_=I("Dropdown");return e(o)?(B(),F("form",z,[s("div",P,[d(w,{label:"Guardar",style:{float:"right"},onClick:u})]),s("section",j,[d(h,{label:"Nom",id:"name",modelValue:e(o).name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(o).name=a),class:b({"p-invalid":l.value.errors.name})},null,8,["modelValue","class"]),d(h,{label:"Descripció",id:"description",modelValue:e(o).description,"onUpdate:modelValue":t[1]||(t[1]=a=>e(o).description=a),class:b({"p-invalid":l.value.errors.description})},null,8,["modelValue","class"]),s("div",null,[G,d(M,{modelValue:e(o).disabled,"onUpdate:modelValue":t[2]||(t[2]=a=>e(o).disabled=a),class:"w-full",binary:!0},null,8,["modelValue"])])]),s("section",O,[s("div",null,[H,d(_,{modelValue:e(o).workcenterTypeId,"onUpdate:modelValue":t[3]||(t[3]=a=>e(o).workcenterTypeId=a),editable:"",options:e(n).workcenterTypes,optionValue:"id",optionLabel:"name",class:b(["w-full",{"p-invalid":l.value.errors.workcenterTypeId}])},null,8,["modelValue","options","class"])]),s("div",null,[J,d(_,{modelValue:e(o).areaId,"onUpdate:modelValue":t[4]||(t[4]=a=>e(o).areaId=a),editable:"",options:e(n).areas,optionValue:"id",optionLabel:"name",class:b(["w-full",{"p-invalid":l.value.errors.areaId}])},null,8,["modelValue","options","class"])]),s("div",null,[K,d(_,{modelValue:e(o).shiftId,"onUpdate:modelValue":t[5]||(t[5]=a=>e(o).shiftId=a),editable:"",options:e(c).shifts,optionValue:"id",optionLabel:"name",class:b(["w-full",{"p-invalid":l.value.errors.shiftId}])},null,8,["modelValue","options","class"])])])])):q("",!0)}}}),se=T({__name:"Workcenter",setup(y){const m=g(k.EDIT),p=L(),v=S(),n=C(),{workcenter:c}=x(n),o=async()=>{await n.fetchWorkcenter(p.params.id);let r="";c.value?(m.value=k.EDIT,r=`Màquina: ${c.value.name}`):(m.value=k.CREATE,n.setNewWorkcenter(p.params.id),r="Alta de màquina"),v.setMenuItem({icon:N.BUILDING,backButtonVisible:!0,title:r})};D(async()=>{await o()});const V=E(),l=async()=>{const r=c.value;let u=!1,i="";m.value===k.CREATE?(u=await n.createWorkcenter(r),i="Màquina creada correctament"):(u=await n.updateWorkcenter(r.id,r),i="Màquina actualizada correctament"),u&&(V.add({severity:"success",summary:i,life:5e3}),W.back())};return(r,u)=>e(c)?(B(),U(Q,{key:0,workcenter:e(c),onSubmit:l},null,8,["workcenter"])):q("",!0)}});export{se as default};
