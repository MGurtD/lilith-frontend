import{d as I,j as T,z as E,r as x,h as V,k as o,c as h,e as i,i as c,n as p,y,l as B,a as C,F as b,v as D,u as L,o as g,m as N,P as U,L as W}from"./index-5e079de4.js";import{c as A,a as k,F as S}from"./form-validator-f8953ae6.js";import{u as M}from"./plantmodel-b5c92e3c.js";import"./_commonjsHelpers-725317a4.js";import"./index-807fa16d.js";import"./base.service-4c53d7ae.js";const $={key:0},R={class:"two-columns"},z={class:"three-columns"},P=i("label",{class:"block text-900 mb-2"},"Tipus",-1),j=i("label",{class:"block text-900 mb-2"},"Area",-1),G=i("label",{class:"block text-900 mb-2"},"Desactivat",-1),O={class:"mt-2"},H=I({__name:"FormWorkcenter",props:{workcenter:{}},emits:["submit","cancel"],setup(_,{emit:d}){const u=_,v=T(),r=M(),{workcenter:e}=E(r),f=A().shape({name:k().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:k().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),workcenterTypeId:k().required("El tipus es obligatori"),areaId:k().required("L'area es obligatoria")}),l=x({result:!1,errors:{}}),w=()=>{const s=new S(f);l.value=s.validate(u.workcenter)},t=async()=>{if(w(),l.value.result)d("submit",u.workcenter);else{let s="";Object.entries(l.value.errors).forEach(a=>{s+=`${a[1].map(m=>m)}.   `}),v.add({severity:"warn",summary:"Formulari inválid",detail:s,life:5e3})}};return(s,a)=>{const m=V("Dropdown"),q=V("Checkbox"),F=V("Button");return o(e)?(C(),h("form",$,[i("section",R,[c(y,{class:p(["mb-2",{"p-invalid":l.value.errors.name}]),label:"Nom",id:"name",modelValue:o(e).name,"onUpdate:modelValue":a[0]||(a[0]=n=>o(e).name=n)},null,8,["modelValue","class"]),c(y,{class:p(["mb-2",{"p-invalid":l.value.errors.description}]),label:"Descripció",id:"description",modelValue:o(e).description,"onUpdate:modelValue":a[1]||(a[1]=n=>o(e).description=n)},null,8,["modelValue","class"])]),i("section",z,[i("div",null,[P,c(m,{modelValue:o(e).workcenterTypeId,"onUpdate:modelValue":a[2]||(a[2]=n=>o(e).workcenterTypeId=n),editable:"",options:o(r).workcenterTypes,optionValue:"id",optionLabel:"name",class:p(["w-full",{"p-invalid":l.value.errors.workcenterTypeId}])},null,8,["modelValue","options","class"])]),i("div",null,[j,c(m,{modelValue:o(e).areaId,"onUpdate:modelValue":a[3]||(a[3]=n=>o(e).areaId=n),editable:"",options:o(r).areas,optionValue:"id",optionLabel:"name",class:p(["w-full",{"p-invalid":l.value.errors.areaId}])},null,8,["modelValue","options","class"])]),i("div",null,[G,c(q,{modelValue:o(e).disabled,"onUpdate:modelValue":a[4]||(a[4]=n=>o(e).disabled=n),class:"w-full",binary:!0},null,8,["modelValue"])])]),i("div",O,[c(F,{label:"Guardar",class:"mr-2",onClick:t})])])):B("",!0)}}}),ee=I({__name:"Workcenter",setup(_){const d=x(b.EDIT),u=D(),v=L(),r=M(),{workcenter:e}=E(r),f=async()=>{await r.fetchWorkcenter(u.params.id);let t="";e.value?(d.value=b.EDIT,t=`Màquina: ${e.value.name}`):(d.value=b.CREATE,r.setNewWorkcenter(u.params.id),t="Alta de màquina"),v.setMenuItem({icon:U.BUILDING,backButtonVisible:!0,title:t})};g(async()=>{await f()});const l=T(),w=async()=>{const t=e.value;let s=!1,a="";d.value===b.CREATE?(s=await r.createWorkcenter(t),a="Màquina creada correctament"):(s=await r.updateWorkcenter(t.id,t),a="Màquina actualizada correctament"),s&&(l.add({severity:"success",summary:a,life:5e3}),W.back())};return(t,s)=>o(e)?(C(),N(H,{key:0,workcenter:o(e),onSubmit:w},null,8,["workcenter"])):B("",!0)}});export{ee as default};
