import{d as $,h as b,c as _,e as r,i as t,k as i,z as y,L as U,a as u,s as k,o as R,j as L,r as F,m as C,l as I}from"./index-d6370003.js";import{_ as N,a as A}from"./DropdownReferenceType.vue_vue_type_script_setup_true_lang-fe181237.js";import{u as E}from"./tax-fc3b08e2.js";import{u as S}from"./reference-350638b3.js";import{u as T}from"./plantmodel-07cd1012.js";import{R as f}from"./index-7cbe1881.js";import{a as p,c as h,d as w,F as q}from"./form-validator-76860c5e.js";const D={class:"three-columns"},B={class:"mt-1"},M={class:"mt-1"},O=r("label",{class:"block text-900 mb-2"},"Format",-1),P={class:"mt-1"},Y=r("label",{class:"block text-900 mb-2"},"Impost",-1),j={class:"three-columns"},z={class:"mt-1"},G=r("label",{class:"block text-900 mb-2"},"Desactivada",-1),x=$({__name:"FormReferenceMaterial",props:{reference:{}},setup(v){const m=E(),a=S();return(o,e)=>{const n=b("Dropdown"),c=b("Checkbox");return u(),_(U,null,[r("section",D,[r("div",B,[t(N,{label:"Tipus de material",modelValue:o.reference.referenceTypeId,"onUpdate:modelValue":e[0]||(e[0]=l=>o.reference.referenceTypeId=l)},null,8,["modelValue"])]),r("div",M,[O,t(n,{modelValue:o.reference.referenceFormatId,"onUpdate:modelValue":e[1]||(e[1]=l=>o.reference.referenceFormatId=l),editable:"",options:i(a).referenceFormats,optionValue:"id",optionLabel:"description",class:"w-full"},null,8,["modelValue","options"])]),r("div",P,[Y,t(n,{modelValue:o.reference.taxId,"onUpdate:modelValue":e[2]||(e[2]=l=>o.reference.taxId=l),editable:"",options:i(m).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",j,[r("div",z,[t(y,{type:i(k).CURRENCY,label:"Últim cost",id:"lastCost",modelValue:o.reference.lastCost,"onUpdate:modelValue":e[3]||(e[3]=l=>o.reference.lastCost=l),disabled:""},null,8,["type","modelValue"])]),r("div",null,[G,t(c,{modelValue:o.reference.disabled,"onUpdate:modelValue":e[4]||(e[4]=l=>o.reference.disabled=l),binary:!0},null,8,["modelValue"])])])],64)}}}),H={class:"three-columns"},J={class:"mt-1"},K=r("label",{class:"block text-900 mb-2"},"Impost",-1),Q={class:"mt-1"},W=r("label",{class:"block text-900 mb-2"},"Àrea de producció",-1),X=$({__name:"FormReferenceTool",props:{reference:{}},setup(v){const m=E(),a=T();return R(async()=>{m.taxes||await m.fetchAll(),await a.fetchAreas()}),(o,e)=>{const n=b("Dropdown");return u(),_("section",H,[r("div",J,[K,t(n,{modelValue:o.reference.taxId,"onUpdate:modelValue":e[0]||(e[0]=c=>o.reference.taxId=c),editable:"",options:i(m).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),r("div",Q,[W,t(n,{modelValue:o.reference.areaId,"onUpdate:modelValue":e[1]||(e[1]=c=>o.reference.areaId=c),editable:"",options:i(a).areas,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])])}}}),Z={class:"four-columns"},ee={class:"mt-1"},oe={class:"mt-1"},re={class:"mt-1"},se=r("label",{class:"block text-900 mb-2"},"Impost",-1),le=r("label",{class:"block text-900 mb-2"},"Desactivada",-1),te=$({__name:"FormReferenceService",props:{reference:{}},emits:["submit","cancel"],setup(v,{emit:m}){const a=E();return R(async()=>{a.taxes||await a.fetchAll()}),(o,e)=>{const n=b("Dropdown"),c=b("Checkbox");return u(),_("section",Z,[r("div",ee,[t(y,{type:i(k).CURRENCY,label:"Preu servei",modelValue:o.reference.price,"onUpdate:modelValue":e[0]||(e[0]=l=>o.reference.price=l)},null,8,["type","modelValue"])]),r("div",oe,[t(y,{type:i(k).CURRENCY,label:"Preu transport",modelValue:o.reference.transportAmount,"onUpdate:modelValue":e[1]||(e[1]=l=>o.reference.transportAmount=l)},null,8,["type","modelValue"])]),r("div",re,[se,t(n,{modelValue:o.reference.taxId,"onUpdate:modelValue":e[2]||(e[2]=l=>o.reference.taxId=l),editable:"",options:i(a).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),r("div",null,[le,t(c,{modelValue:o.reference.disabled,"onUpdate:modelValue":e[3]||(e[3]=l=>o.reference.disabled=l),binary:!0},null,8,["modelValue"])])])}}}),ae=r("br",null,null,-1),ne={key:0},ie={class:"three-columns"},de={class:"mt-1"},ce={class:"mt-1"},me={class:"mt-1"},ve=$({__name:"FormMaterial",props:{reference:{}},emits:["submit"],setup(v,{emit:m}){const a=v,o=L(),e={code:p().required("El codi és obligatoria").max(50,"El codi no pot superar els 50 carácters"),description:p().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")},n=F({result:!1,errors:{}}),c=()=>{let s={};a.reference.categoryName===f.MATERIAL?s=h().shape({...e,taxId:p().required("L'IVA és obligatori"),referenceTypeId:p().required("El tipus de referència és obligatori"),referenceFormatId:p().required("El format és obligatori")}):a.reference.categoryName===f.SERVICE?s=h().shape({...e,price:w().required("El preu és obligatori"),transportAmount:w().required("El preu de transport és obligatori")}):a.reference.categoryName===f.TOOL&&(s=h().shape({...e,areaId:p().required("L'àrea és obligatoria"),taxId:p().required("L'IVA és obligatori")}));const d=new q(s);n.value=d.validate(a.reference)},l=async()=>{if(c(),n.value.result)m("submit",a.reference);else{let s="";Object.entries(n.value.errors).forEach(d=>{s+=`${d[1].map(g=>g)}.   `}),o.add({severity:"warn",summary:"Formulari inválid",detail:s,life:5e3})}};return(s,d)=>{const g=b("Button");return u(),_(U,null,[r("div",null,[t(g,{label:"Guardar",class:"grid_add_row_button",size:"small",onClick:l}),ae]),s.reference?(u(),_("form",ne,[r("section",ie,[r("div",de,[t(y,{class:"mb-2",label:"Codi",id:"code",modelValue:s.reference.code,"onUpdate:modelValue":d[0]||(d[0]=V=>s.reference.code=V)},null,8,["modelValue"])]),r("div",ce,[t(y,{class:"mb-2",label:"Descripció",id:"description",modelValue:s.reference.description,"onUpdate:modelValue":d[1]||(d[1]=V=>s.reference.description=V)},null,8,["modelValue"])]),r("div",me,[t(A,{label:"Categoria",modelValue:s.reference.categoryName,"onUpdate:modelValue":d[2]||(d[2]=V=>s.reference.categoryName=V),disabled:""},null,8,["modelValue"])])]),s.reference.categoryName===i(f).MATERIAL?(u(),C(x,{key:0,reference:s.reference},null,8,["reference"])):I("",!0),s.reference.categoryName===i(f).TOOL?(u(),C(X,{key:1,reference:s.reference},null,8,["reference"])):I("",!0),s.reference.categoryName===i(f).SERVICE?(u(),C(te,{key:2,reference:s.reference},null,8,["reference"])):I("",!0)])):I("",!0)],64)}}});export{ve as _};
