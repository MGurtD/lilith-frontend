import{F as S}from"./file.service-78707ff8.js";import{O as I,a as l,c,e as s,J as _,Q as u,R as L,d as N,j as T,x as z,r as w,S as A,o as O,h as x,i as h,w as k,k as r,G,T as M,D as F,P as n,n as m,l as $,f as R}from"./index-3b4220ae.js";import{b as W}from"./functions-2e154ea4.js";var q={root:"p-toolbar p-component",start:"p-toolbar-group-start p-toolbar-group-left",center:"p-toolbar-group-center",end:"p-toolbar-group-end p-toolbar-group-right"},U=I.extend({name:"toolbar",classes:q}),j={name:"BaseToolbar",extends:L,props:{ariaLabelledby:{type:String,default:null}},style:U,provide:function(){return{$parentInstance:this}}},E={name:"Toolbar",extends:j,inheritAttrs:!1},J=["aria-labelledby"];function Q(t,i,v,b,d,y){return l(),c("div",u({class:t.cx("root"),role:"toolbar","aria-labelledby":t.ariaLabelledby},t.ptmi("root")),[s("div",u({class:t.cx("start")},t.ptm("start")),[_(t.$slots,"start")],16),s("div",u({class:t.cx("center")},t.ptm("center")),[_(t.$slots,"center")],16),s("div",u({class:t.cx("end")},t.ptm("end")),[_(t.$slots,"end")],16)],16,J)}E.render=Q;const H={class:"base_input"},K={class:"file_viewer_title"},V={class:"file-viewer"},X={class:"file-viewer-item-type"},Y={class:"file-viewer-item-actions"},Z=["onClick"],ee=["onClick"],te=N({__name:"FileEntityPicker",props:{title:{},entity:{},id:{}},setup(t){const i=t,v=T(),b=z(),d=new S,y=w(void 0),g=w(i.id);A(()=>i.id,(e,a)=>{g.value=e,console.log(`FileEntityPicker. entity > ${i.entity} | id > ${e}`),e&&e!==a&&p()});const p=async()=>{y.value=await d.GetEntityFiles(i.entity,g.value)};O(async()=>{setTimeout(()=>{p()},200)});const C=async()=>{const e=document.createElement("input");e.type="file",e.onchange=async a=>{const f=a.target.files[0];if(!await d.Upload(f,i.entity,i.id)){v.add({severity:"error",detail:"Error al carregar l'arxiu"});return}await p()},e.click()},D=async e=>{const a=await d.Download(e);W(e.originalName,a)},P=async e=>{b.require({message:"EstÃ  segur que vol eliminar l'arxiu seleccionat",accept:async()=>{var a=await d.Delete(e.id);if(!a){v.add({severity:"error",detail:"Error al eliminar l'arxiu"});return}await p()}})};return(e,a)=>{const f=x("Button");return l(),c("div",H,[h(r(E),null,{start:k(()=>[s("p",K,F(e.title),1)]),end:k(()=>[h(f,{size:"small",rounded:"",icon:r(n).UPLOAD,onClick:C},null,8,["icon"])]),_:1}),s("section",V,[(l(!0),c(G,null,M(y.value,o=>(l(),c("article",{class:"file-viewer-item",key:e.id},[s("div",X,[o.type===0?(l(),c("i",{key:0,class:m(o.originalName.endsWith("docx")?r(n).FILE_WORD:r(n).FILE_PDF),style:{"font-size":"3.5rem"}},null,2)):$("",!0),o.type===1?(l(),c("i",{key:1,class:m(r(n).IMAGE),style:{"font-size":"3.5rem"}},null,2)):$("",!0),s("p",null,F(o.originalName.substring(0,20)),1)]),s("div",Y,[s("div",{class:"file-viewer-item-action file-viewer-item-action-download",onClick:B=>D(o)},[s("i",{class:m(r(n).DOWNLOAD),style:{"font-size":"1rem"}},null,2)],8,Z),s("div",{class:"file-viewer-item-action file-viewer-item-action-delete",onClick:B=>P(o)},[s("i",{class:m(r(n).TIMES)},null,2)],8,ee)])]))),128))])])}}});const oe=R(te,[["__scopeId","data-v-44ca20c4"]]);export{oe as F};
