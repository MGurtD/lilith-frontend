import{d as N,g as A,u as W,j as E,x as L,o as q,P as m,r as M,T as R,h as u,m as P,w as d,a as j,e as r,i as n,k as p,G as _,H as w,n as H,y as U}from"./index-797fdaef.js";import{u as $}from"./plantmodel-4b5a051b.js";import{u as F}from"./shift-bcffebb8.js";import"./index-e45ffdc0.js";const G={class:"flex flex-wrap align-items-center justify-content-between gap-2"},z={class:"datatable-filter"},J={class:"filter-field"},K=r("label",{class:"block text-900 mb-2"},"Tipus",-1),O={class:"filter-field"},Q=r("label",{class:"block text-900 mb-2"},"Àrea",-1),X={class:"datatable-buttons"},Y=["onClick"],ne=N({__name:"Workcenters",setup(Z){const f=A(),h=W(),k=E(),y=L(),o=$(),v=F();q(async()=>{await o.fetchWorkcenters(),await o.fetchWorkcenterTypes(),await o.fetchAreas(),await v.fetchAllShifts(),h.setMenuItem({icon:m.CALENDAR,title:"Gestió de màquines"})});const s=M({areaId:void 0,workcenterTypeId:void 0}),b=R(()=>{if(!o.workcenters)return[];let t=o.workcenters;return s.value.areaId&&(t=t.filter(e=>e.areaId===s.value.areaId)),s.value.workcenterTypeId&&(t=t.filter(e=>e.workcenterTypeId===s.value.workcenterTypeId)),t}),I=()=>{s.value.areaId=void 0,s.value.workcenterTypeId=void 0},T=t=>{var l;const e=(l=o.areas)==null?void 0:l.find(i=>i.id===t);return e?e.name:""},C=t=>{var l;const e=(l=o.workcenterTypes)==null?void 0:l.find(i=>i.id===t);return e?e.name:""},g=()=>{f.push({path:`/workcenter/${U()}`})},S=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||f.push({path:`/workcenter/${t.data.id}`})},B=(t,e)=>{y.require({target:t.currentTarget,message:`Está segur que vol eliminar la màquina ${e.name}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await o.deleteWorkcenter(e.id)&&(k.add({severity:"success",summary:"Eliminat",life:3e3}),await o.fetchWorkcenters())}})};return(t,e)=>{const l=u("Dropdown"),i=u("Button"),c=u("Column"),V=u("BooleanColumn"),x=u("DataTable");return j(),P(x,{value:b.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",sortMode:"multiple",onRowClick:S},{header:d(()=>[r("div",G,[r("div",z,[r("div",J,[K,n(l,{modelValue:s.value.workcenterTypeId,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.workcenterTypeId=a),editable:"",options:p(o).workcenterTypes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),r("div",O,[Q,n(l,{modelValue:s.value.areaId,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.areaId=a),editable:"",options:p(o).areas,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("div",X,[n(i,{class:"datatable-button mr-2",icon:p(m).FILTER_SLASH,rounded:"",raised:"",onClick:I},null,8,["icon"]),n(i,{icon:p(m).PLUS,rounded:"",raised:"",onClick:g},null,8,["icon"])])])]),default:d(()=>[n(c,{field:"name",header:"Nom",style:{width:"20%"}}),n(c,{field:"description",header:"Descripció",style:{width:"40%"}}),n(c,{header:"Tipus",style:{width:"15%"}},{body:d(a=>[_(w(C(a.data.workcenterTypeId)),1)]),_:1}),n(c,{header:"Area",style:{width:"15%"}},{body:d(a=>[_(w(T(a.data.areaId)),1)]),_:1}),n(c,{header:"Desactivat",style:{width:"10%"}},{body:d(a=>[n(V,{value:a.data.disabled},null,8,["value"])]),_:1}),n(c,null,{body:d(a=>[r("i",{class:H([p(m).TIMES,"grid_delete_column_button"]),onClick:D=>B(D,a.data)},null,10,Y)]),_:1})]),_:1},8,["value"])}}});export{ne as default};
