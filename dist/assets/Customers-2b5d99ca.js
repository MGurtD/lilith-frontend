import{d as B,r as D,j as q,x as H,g as $,u as P,o as A,P as u,h as d,c as M,i as e,k as i,w as a,G as V,a as j,e as c,n as p,D as F}from"./index-69c3f293.js";import{u as G}from"./customers-11bdd44c.js";import{v as T}from"./v4-a960c1f4.js";import"./base.service-330045d1.js";const R=c("span",null,"Clients",-1),L=["onClick"],U=c("span",null,"Tipus de client",-1),z=["onClick"],X=B({__name:"Customers",setup(K){const _=D(0),f=q(),y=H(),m=$(),g=P(),n=G();A(async()=>{await n.fetchCustomers(),await n.fetchCustomerTypes(),g.setMenuItem({title:"Clients",icon:u.HASHTAG})});const w=t=>{var r;const o=(r=n.customerTypes)==null?void 0:r.find(s=>s.id===t);if(o)return o.name},I=(t,o)=>{y.require({target:t.currentTarget,message:`Está segur que vol eliminar el client ${o.comercialName}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await n.deleteCustomer(o.id)&&(f.add({severity:"success",summary:"Eliminat",life:3e3}),await n.fetchCustomers())}})},k=(t,o)=>{y.require({target:t.currentTarget,message:`Está segur que vol eliminar el tipus de client ${o.name}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await n.deleteCustomerType(o.id)&&(f.add({severity:"success",summary:"Eliminat",life:3e3}),await n.fetchCustomerTypes())}})},N=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||m.push({path:`/customers/${t.data.id}`})},S=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||m.push({path:`/customer-types/${t.data.id}`})},x=()=>{_.value===0?m.push({path:`/customers/${T()}`}):m.push({path:`/customer-types/${T()}`})};return(t,o)=>{const r=d("Button"),s=d("Column"),C=d("BooleanColumn"),v=d("DataTable"),b=d("TabPanel"),E=d("TabView");return j(),M(V,null,[e(r,{icon:i(u).PLUS,class:"grid_add_row_button",rounded:"",onClick:x},null,8,["icon"]),e(E,{activeIndex:_.value,"onUpdate:activeIndex":o[0]||(o[0]=l=>_.value=l)},{default:a(()=>[e(b,null,{header:a(()=>[c("i",{class:p([i(u).LINK,"mr-2"])},null,2),R]),default:a(()=>[e(v,{value:i(n).customers,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",onRowClick:N},{default:a(()=>[e(s,{field:"comercialName",header:"Nom comercial",sortable:"",style:{width:"20%"}}),e(s,{field:"taxName",header:"Nom Fiscal",style:{width:"20%"}}),e(s,{field:"vatNumber",header:"CIF",style:{width:"20%"}}),e(s,{header:"Tipus",style:{width:"20%"}},{body:a(l=>[c("span",null,F(w(l.data.customerTypeId)),1)]),_:1}),e(s,{header:"Desactivat",sortable:"",style:{width:"20%"}},{body:a(l=>[e(C,{value:l.data.disabled,showColor:!1},null,8,["value"])]),_:1}),e(s,null,{body:a(l=>[c("i",{class:p([i(u).TIMES,"grid_delete_column_button"]),onClick:h=>I(h,l.data)},null,10,L)]),_:1})]),_:1},8,["value"])]),_:1}),e(b,null,{header:a(()=>[c("i",{class:p([i(u).HASHTAG,"mr-2"])},null,2),U]),default:a(()=>[e(v,{value:i(n).customerTypes,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",onRowClick:S},{default:a(()=>[e(s,{field:"name",header:"Nom",style:{width:"33%"}}),e(s,{field:"description",header:"Descripció",style:{width:"33%"}}),e(s,{header:"Desactivat",style:{width:"33%"}},{body:a(l=>[e(C,{value:l.data.disabled},null,8,["value"])]),_:1}),e(s,null,{body:a(l=>[c("i",{class:p([i(u).TIMES,"grid_delete_column_button"]),onClick:h=>k(h,l.data)},null,10,z)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["activeIndex"])],64)}}});export{X as default};
