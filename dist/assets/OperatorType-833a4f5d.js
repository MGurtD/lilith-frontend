import{d as E,o as w,j as C,z as B,r as x,h as _,k as t,c as M,e as m,i as p,n as v,y as T,l as F,a as O,F as u,v as N,u as $,m as g,P as D,L as S}from"./index-911ee129.js";import{c as U,a as k,d as A,F as L}from"./form-validator-f8953ae6.js";import{u as h}from"./plantmodel-5a4f0b93.js";import"./_commonjsHelpers-725317a4.js";import"./index-3a886172.js";import"./base.service-f2c5646d.js";const R={key:0},q={class:"four-columns"},z=m("label",{class:"block text-900 mb-2"},"Desactivat",-1),P={class:"mt-2"},j=E({__name:"FormOperatorType",props:{operatortype:{}},emits:["submit","cancel"],setup(V,{emit:n}){const c=V;w(async()=>{await r.fetchOperatorTypes()});const d=C(),r=h(),{operatorType:e}=B(r),b=U().shape({name:k().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:k().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),cost:A().required("El cost es obligatori").min(0)}),l=x({result:!1,errors:{}}),y=()=>{const s=new L(b);l.value=s.validate(c.operatortype)},o=async()=>{if(y(),l.value.result)n("submit",c.operatortype);else{let s="";Object.entries(l.value.errors).forEach(a=>{s+=`${a[1].map(f=>f)}.   `}),d.add({severity:"warn",summary:"Formulari inválid",detail:s,life:5e3})}};return(s,a)=>{const f=_("Checkbox"),I=_("Button");return t(e)?(O(),M("form",R,[m("section",q,[p(T,{class:v(["mb-2",{"p-invalid":l.value.errors.name}]),label:"Nom",id:"name",modelValue:t(e).name,"onUpdate:modelValue":a[0]||(a[0]=i=>t(e).name=i)},null,8,["modelValue","class"]),p(T,{class:v(["mb-2",{"p-invalid":l.value.errors.description}]),label:"Descripció",id:"description",modelValue:t(e).description,"onUpdate:modelValue":a[1]||(a[1]=i=>t(e).description=i)},null,8,["modelValue","class"]),p(T,{class:v(["mb-2",{"p-invalid":l.value.errors.cost}]),label:"Cost/h",id:"cost",modelValue:t(e).cost,"onUpdate:modelValue":a[2]||(a[2]=i=>t(e).cost=i)},null,8,["modelValue","class"]),m("div",null,[z,p(f,{modelValue:t(e).disabled,"onUpdate:modelValue":a[3]||(a[3]=i=>t(e).disabled=i),class:"w-full",binary:!0},null,8,["modelValue"])])]),m("div",P,[p(I,{label:"Guardar",class:"mr-2",onClick:o})])])):F("",!0)}}}),X=E({__name:"OperatorType",setup(V){const n=x(u.EDIT),c=N(),d=$(),r=h(),{operatorType:e}=B(r),b=async()=>{await r.fetchOperatorType(c.params.id);let o="";e.value?(n.value=u.EDIT,o=`Tipus d'operari: ${e.value.name}`):(n.value=u.CREATE,r.setNewOperatorType(c.params.id),o="Alta de tipus d' operari"),d.setMenuItem({icon:D.BUILDING,backButtonVisible:!0,title:o})};w(async()=>{await b()});const l=C(),y=async()=>{const o=e.value;let s=!1,a="";n.value===u.CREATE?(s=await r.createOperatorType(o),a="Tipus d'operari creat correctament"):(s=await r.updateOperatorType(o.id,o),a="Tipus d'operari actualizat correctament"),s&&(l.add({severity:"success",summary:a,life:5e3}),S.back())};return(o,s)=>t(e)?(O(),g(j,{key:0,operatortype:t(e),onSubmit:y},null,8,["operatortype"])):F("",!0)}});export{X as default};
