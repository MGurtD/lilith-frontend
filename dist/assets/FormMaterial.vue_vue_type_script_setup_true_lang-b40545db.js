import{d as C,h as v,c as b,e as r,i as t,k as c,z as V,L as R,a as d,s as I,j as F,r as U,m as k,l as y}from"./index-709c40c8.js";import{a as N,_ as q}from"./DropdownReferenceType.vue_vue_type_script_setup_true_lang-eba1e3e7.js";import{u as L}from"./tax-c1d8198c.js";import{u as T}from"./reference-ced38a82.js";import{c as h,a as m,d as g,F as A}from"./form-validator-6d089293.js";import{R as f}from"./index-7cbe1881.js";const B={class:"three-columns"},S={class:"mt-1"},w={class:"mt-1"},D=r("label",{class:"block text-900 mb-2"},"Format",-1),M={class:"mt-1"},O=r("label",{class:"block text-900 mb-2"},"Impost",-1),Y={class:"three-columns"},j={class:"mt-1"},z=r("label",{class:"block text-900 mb-2"},"Desactivada",-1),P=C({__name:"FormReferenceMaterial",props:{reference:{}},setup(_){const u=L(),l=T();return(o,s)=>{const a=v("Dropdown"),E=v("Checkbox");return d(),b(R,null,[r("section",B,[r("div",S,[t(N,{label:"Tipus de material",modelValue:o.reference.referenceTypeId,"onUpdate:modelValue":s[0]||(s[0]=n=>o.reference.referenceTypeId=n)},null,8,["modelValue"])]),r("div",w,[D,t(a,{modelValue:o.reference.referenceFormatId,"onUpdate:modelValue":s[1]||(s[1]=n=>o.reference.referenceFormatId=n),editable:"",options:c(l).referenceFormats,optionValue:"id",optionLabel:"description",class:"w-full"},null,8,["modelValue","options"])]),r("div",M,[O,t(a,{modelValue:o.reference.taxId,"onUpdate:modelValue":s[2]||(s[2]=n=>o.reference.taxId=n),editable:"",options:c(u).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",Y,[r("div",j,[t(V,{type:c(I).CURRENCY,label:"Últim cost",id:"lastCost",modelValue:o.reference.lastCost,"onUpdate:modelValue":s[3]||(s[3]=n=>o.reference.lastCost=n),disabled:""},null,8,["type","modelValue"])]),r("div",null,[z,t(E,{modelValue:o.reference.disabled,"onUpdate:modelValue":s[4]||(s[4]=n=>o.reference.disabled=n),binary:!0},null,8,["modelValue"])])])],64)}}}),G=C({__name:"FormReferenceTool",props:{reference:{}},setup(_){return(u,l)=>(d(),b("div"))}}),H={class:"three-columns"},J={class:"mt-1"},K={class:"mt-1"},Q=r("label",{class:"block text-900 mb-2"},"Desactivada",-1),W=C({__name:"FormReferenceService",props:{reference:{}},emits:["submit","cancel"],setup(_,{emit:u}){return F(),h().shape({code:m().required("El codi és obligatori").max(50,"El codi no pot superar els 50 carácters"),description:m().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),price:g().required("El preu és obligatori"),transportAmount:g().required("El preu de transport és obligatori")}),(l,o)=>{const s=v("Checkbox");return d(),b("section",H,[r("div",J,[t(V,{type:c(I).CURRENCY,label:"Preu servei",modelValue:l.reference.price,"onUpdate:modelValue":o[0]||(o[0]=a=>l.reference.price=a)},null,8,["type","modelValue"])]),r("div",K,[t(V,{type:c(I).CURRENCY,label:"Preu transport",modelValue:l.reference.transportAmount,"onUpdate:modelValue":o[1]||(o[1]=a=>l.reference.transportAmount=a)},null,8,["type","modelValue"])]),r("div",null,[Q,t(s,{modelValue:l.reference.disabled,"onUpdate:modelValue":o[2]||(o[2]=a=>l.reference.disabled=a),binary:!0},null,8,["modelValue"])])])}}}),X=r("br",null,null,-1),Z={key:0},x={class:"three-columns"},ee={class:"mt-1"},re={class:"mt-1"},oe={class:"mt-1"},de=C({__name:"FormMaterial",props:{reference:{}},emits:["submit"],setup(_,{emit:u}){const l=_,o=F(),s={code:m().required("El codi és obligatoria").max(50,"El codi no pot superar els 50 carácters"),description:m().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")},a=U({result:!1,errors:{}}),E=()=>{let e={};l.reference.categoryName===f.MATERIAL?e=h().shape({...s,taxId:m().required("L'IVA és obligatori"),referenceTypeId:m().required("El tipus de referència és obligatori"),referenceFormatId:m().required("El format és obligatori")}):l.reference.categoryName===f.SERVICE&&(e=h().shape({...s,price:g().required("El preu és obligatori"),transportAmount:g().required("El preu de transport és obligatori")}));const i=new A(e);a.value=i.validate(l.reference)},n=async()=>{if(E(),a.value.result)u("submit",l.reference);else{let e="";Object.entries(a.value.errors).forEach(i=>{e+=`${i[1].map($=>$)}.   `}),o.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,i)=>{const $=v("Button");return d(),b(R,null,[r("div",null,[t($,{label:"Guardar",class:"grid_add_row_button",size:"small",onClick:n}),X]),e.reference?(d(),b("form",Z,[r("section",x,[r("div",ee,[t(V,{class:"mb-2",label:"Codi",id:"code",modelValue:e.reference.code,"onUpdate:modelValue":i[0]||(i[0]=p=>e.reference.code=p)},null,8,["modelValue"])]),r("div",re,[t(V,{class:"mb-2",label:"Descripció",id:"description",modelValue:e.reference.description,"onUpdate:modelValue":i[1]||(i[1]=p=>e.reference.description=p)},null,8,["modelValue"])]),r("div",oe,[t(q,{label:"Categoria",modelValue:e.reference.categoryName,"onUpdate:modelValue":i[2]||(i[2]=p=>e.reference.categoryName=p),disabled:""},null,8,["modelValue"])])]),e.reference.categoryName===c(f).MATERIAL?(d(),k(P,{key:0,reference:e.reference},null,8,["reference"])):y("",!0),e.reference.categoryName===c(f).TOOL?(d(),k(G,{key:1,reference:e.reference},null,8,["reference"])):y("",!0),e.reference.categoryName===c(f).SERVICE?(d(),k(W,{key:2,reference:e.reference},null,8,["reference"])):y("",!0)])):y("",!0)],64)}}});export{de as _};
