import{u as x}from"./suppliers-50a1eacc.js";import{d as h,j as w,E as S,o as k,r as C,h as c,a as D,c as E,e as s,i,k as d,D as I}from"./index-eea64e26.js";import{c as g,a as u,e as B,F}from"./form-validator-9374e474.js";const y={class:"mt-2"},L=s("label",{class:"block text-900 mb-2"},"Proveïdor",-1),N={class:"mt-2"},$=s("label",{class:"block text-900 mb-2"},"Exercici",-1),T={class:"mt-2"},U=s("label",{class:"block text-900 mb-2"},"Data",-1),j={class:"mt-2"},J=h({__name:"FormCreatePurchaseDocument",props:{createRequest:{}},emits:["submit"],setup(m,{emit:p}){const a=m,b=w(),l=S(),f=x();k(async()=>{var t;l.exercises||await l.fetchActive();var e=(t=l.exercises)==null?void 0:t.find(o=>o.name===new Date().getFullYear().toString());e&&(a.createRequest.exerciseId=e.id)});const v=g().shape({exerciseId:u().required("L'exercici és obligatori"),supplierId:u().required("El client és obligatori"),date:B().required("La data és obligatoria")}),n=C({result:!1,errors:{}}),q=()=>{const e=new F(v);n.value=e.validate(a.createRequest)},V=()=>{if(q(),n.value.result)a.createRequest.date=I(a.createRequest.date),p("submit",a.createRequest);else{let e="";Object.entries(n.value.errors).forEach(t=>{e+=`${t[1].map(o=>o)}.   `}),b.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,t)=>{const o=c("Dropdown"),_=c("Calendar"),R=c("Button");return D(),E("form",null,[s("div",y,[L,i(o,{class:"w-full",modelValue:e.createRequest.supplierId,"onUpdate:modelValue":t[0]||(t[0]=r=>e.createRequest.supplierId=r),editable:"",options:d(f).suppliers,optionValue:"id",optionLabel:"comercialName"},null,8,["modelValue","options"])]),s("div",N,[$,i(o,{class:"w-full",modelValue:e.createRequest.exerciseId,"onUpdate:modelValue":t[1]||(t[1]=r=>e.createRequest.exerciseId=r),editable:"",options:d(l).exercises,optionValue:"id",optionLabel:"name"},null,8,["modelValue","options"])]),s("div",T,[U,i(_,{modelValue:e.createRequest.date,"onUpdate:modelValue":t[2]||(t[2]=r=>e.createRequest.date=r)},null,8,["modelValue"])]),s("footer",j,[i(R,{label:"Crear",onClick:V,style:{float:"right"}})])])}}});export{J as _};
